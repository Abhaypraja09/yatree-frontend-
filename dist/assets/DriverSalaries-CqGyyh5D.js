import{b as a,j as e,ah as $,K as M,A as w,m as k,X as Y,C as F,ai as X,y as O,aj as _}from"./vendor-BXfTzn-0.js";import{b as G,i as z}from"./index-CTxDrFbq.js";import{S as J}from"./SEO-GJK5pBVT.js";const K=()=>{const{selectedCompany:x}=G(),[A,W]=a.useState([]),[D,m]=a.useState(!0),[o,T]=a.useState(new Date().getMonth()+1),[s,L]=a.useState(new Date().getFullYear()),[p,B]=a.useState(""),[N,g]=a.useState(!1),[R,u]=a.useState(null),[C,j]=a.useState(!1);a.useEffect(()=>{x&&I()},[x,o,s]);const I=async()=>{if(x?._id){m(!0);try{const t=JSON.parse(localStorage.getItem("userInfo")),{data:r}=await z.get(`/api/admin/salary-summary/${x._id}?month=${o}&year=${s}`,{headers:{Authorization:`Bearer ${t.token}`}});W(r||[])}catch(t){console.error(t)}finally{m(!1)}}},v=async t=>{j(!0),g(!0),u(null);try{const r=JSON.parse(localStorage.getItem("userInfo")),{data:f}=await z.get(`/api/admin/salary-details/${t}?month=${o}&year=${s}`,{headers:{Authorization:`Bearer ${r.token}`}});u(f)}catch(r){console.error(r),alert("Error: "+(r.response?.data?.message||r.message)),g(!1)}finally{j(!1)}},c=A.filter(t=>t.name?.toLowerCase().includes(p.toLowerCase())||t.mobile?.includes(p)),E=c.reduce((t,r)=>t+(r.netPayable||0),0),i=R,S=i?.driver?.name||i?.driver?.[0]?.name||"",n=i?.summary||{},h=n.totalWages||0,l=n.parkingTotal||i?.parkingEntries?.reduce((t,r)=>t+(Number(r.amount)||0),0)||0,b=n.totalAdvances||i?.advances?.reduce((t,r)=>t+(Number(r.amount)||0),0)||0,y=n.grandTotal||h+l,d=n.netPayable||y-b;return e.jsxs("div",{className:"container-fluid",style:{paddingBottom:"40px"},children:[e.jsx(J,{title:"Driver Payroll",description:"View driver salary reports, duty days, and advances."}),e.jsxs("header",{className:"flex-resp",style:{justifyContent:"space-between",flexWrap:"wrap",gap:"20px",padding:"30px 0",marginBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("div",{style:{width:"clamp(40px,10vw,50px)",height:"clamp(40px,10vw,50px)",background:"linear-gradient(135deg, white, #f8fafc)",borderRadius:"16px",padding:"8px",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},children:e.jsx($,{size:28,color:"#10b981"})}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[e.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:"#10b981",boxShadow:"0 0 8px #10b981"}}),e.jsx("span",{style:{fontSize:"clamp(9px,2.5vw,10px)",fontWeight:"800",color:"rgba(255,255,255,0.5)",letterSpacing:"1px",textTransform:"uppercase"},children:"Financials"})]}),e.jsxs("h1",{style:{color:"white",fontSize:"clamp(24px,5vw,32px)",fontWeight:"900",margin:0,letterSpacing:"-1px"},children:["Driver ",e.jsx("span",{className:"text-gradient-green",children:"Salaries"})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",flexWrap:"wrap"},children:[e.jsx("select",{value:o,onChange:t=>T(Number(t.target.value)),className:"glass-card",style:{padding:"10px",border:"1px solid rgba(255,255,255,0.1)",color:"white",background:"#0f172a",borderRadius:"10px"},children:Array.from({length:12},(t,r)=>r+1).map(t=>e.jsx("option",{value:t,children:new Date(0,t-1).toLocaleString("default",{month:"long"})},t))}),e.jsx("select",{value:s,onChange:t=>L(Number(t.target.value)),className:"glass-card",style:{padding:"10px",border:"1px solid rgba(255,255,255,0.1)",color:"white",background:"#0f172a",borderRadius:"10px"},children:[2024,2025,2026,2027].map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsxs("div",{className:"glass-card",style:{padding:"0",display:"flex",alignItems:"center",borderRadius:"14px",border:"1px solid rgba(255,255,255,0.08)"},children:[e.jsx(M,{size:18,style:{margin:"0 15px",color:"rgba(255,255,255,0.4)"}}),e.jsx("input",{type:"text",placeholder:"Search...",value:p,onChange:t=>B(t.target.value),style:{background:"transparent",border:"none",color:"white",height:"45px",outline:"none"}})]})]})]}),e.jsxs("div",{className:"glass-card",style:{padding:"20px",marginBottom:"30px",background:"linear-gradient(135deg, rgba(16,185,129,0.1) 0%, rgba(16,185,129,0.05) 100%)",border:"1px solid rgba(16,185,129,0.2)",display:"inline-block"},children:[e.jsxs("p",{style:{fontSize:"11px",fontWeight:"800",color:"rgba(16,185,129,0.8)",marginBottom:"4px",textTransform:"uppercase"},children:["Total Net Payable (",new Date(0,o-1).toLocaleString("default",{month:"short"})," ",s,")"]}),e.jsxs("h3",{style:{fontSize:"28px",fontWeight:"900",color:"white"},children:["₹ ",E.toLocaleString()]})]}),e.jsx("div",{className:"glass-card hide-mobile",style:{padding:"0",overflowX:"auto",border:"1px solid rgba(255,255,255,0.05)",background:"transparent"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:"0 8px",padding:"0 10px",minWidth:"800px"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{textAlign:"left"},children:["Driver","Daily Wage","Duty Days","Total Earnings","Advances (This Month)","Pending Balance","Net Payable"].map(t=>e.jsx("th",{style:{padding:"15px 25px",color:t==="Net Payable"?"#10b981":"var(--text-muted)",fontSize:"10px",fontWeight:"900",textTransform:"uppercase",letterSpacing:"1px"},children:t},t))})}),e.jsx("tbody",{children:e.jsx(w,{children:D?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",style:{textAlign:"center",padding:"40px",color:"white"},children:"Loading report..."})}):c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",style:{textAlign:"center",padding:"40px",color:"var(--text-muted)"},children:"No records found for this period."})}):c.map((t,r)=>e.jsxs(k.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:r*.05},onClick:()=>v(t.driverId),className:"glass-card-hover-effect",style:{background:"rgba(30,41,59,0.4)",borderRadius:"12px",cursor:"pointer"},children:[e.jsxs("td",{style:{padding:"20px 25px",borderTopLeftRadius:"12px",borderBottomLeftRadius:"12px"},children:[e.jsx("div",{style:{fontWeight:"700",color:"white"},children:t.name}),e.jsx("div",{style:{fontSize:"11px",color:"var(--text-muted)"},children:t.mobile})]}),e.jsxs("td",{style:{padding:"20px 25px",color:"rgba(255,255,255,0.7)",fontWeight:"600",fontFamily:"monospace"},children:["₹ ",t.dailyWage]}),e.jsx("td",{style:{padding:"20px 25px",color:"white",fontWeight:"800"},children:t.workingDays||0}),e.jsxs("td",{style:{padding:"20px 25px",color:"#38bdf8",fontWeight:"700"},children:["₹ ",t.totalEarned]}),e.jsxs("td",{style:{padding:"20px 25px",color:"#f43f5e",fontWeight:"700"},children:["₹ ",t.totalAdvances]}),e.jsxs("td",{style:{padding:"20px 25px",color:"#f59e0b",fontWeight:"700"},children:["₹ ",t.pendingAdvance]}),e.jsxs("td",{style:{padding:"20px 25px",borderTopRightRadius:"12px",borderBottomRightRadius:"12px",color:"#10b981",fontWeight:"900",fontSize:"15px"},children:["₹ ",t.netPayable]})]},t.driverId))})})]})}),e.jsx("div",{className:"show-mobile",style:{display:"flex",flexDirection:"column",gap:"15px"},children:c.map(t=>e.jsxs("div",{className:"glass-card",style:{padding:"20px",cursor:"pointer"},onClick:()=>v(t.driverId),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"15px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,color:"white",fontSize:"16px"},children:t.name}),e.jsx("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"12px"},children:t.mobile})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("p",{style:{margin:0,fontSize:"10px",fontWeight:"800",color:"#10b981"},children:"NET PAYABLE"}),e.jsxs("h3",{style:{margin:0,color:"#10b981",fontSize:"18px"},children:["₹ ",t.netPayable]})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",fontSize:"13px"},children:[["DAILY WAGE",`₹ ${t.dailyWage}`,"rgba(255,255,255,0.7)"],["DUTY DAYS",t.workingDays,"white"],["TOTAL EARNINGS",`₹ ${t.totalEarned}`,"white"],["ADVANCES",`₹ ${t.totalAdvances}`,"#f43f5e"]].map(([r,f,P])=>e.jsxs("div",{style:{background:"rgba(255,255,255,0.03)",padding:"10px",borderRadius:"8px"},children:[e.jsx("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"10px"},children:r}),e.jsx("p",{style:{margin:"4px 0 0",color:P,fontWeight:"700"},children:f})]},r))})]},t.driverId))}),e.jsx(w,{children:N&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.8)",backdropFilter:"blur(8px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,padding:"15px"},children:e.jsxs(k.div,{initial:{scale:.95,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:20},className:"glass-card",style:{padding:"0",width:"100%",maxWidth:"800px",maxHeight:"90vh",overflowY:"auto",border:"1px solid rgba(255,255,255,0.1)",background:"#0f172a"},children:[e.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid rgba(255,255,255,0.05)",display:"flex",justifyContent:"space-between",alignItems:"center",background:"linear-gradient(to right, rgba(255,255,255,0.02), transparent)",position:"sticky",top:0,backdropFilter:"blur(10px)",zIndex:5},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{color:"white",fontSize:"18px",fontWeight:"800",margin:0},children:"Salary Breakdown"}),S&&e.jsx("p",{style:{color:"var(--primary)",fontSize:"13px",margin:"4px 0 0",fontWeight:"600"},children:S})]}),e.jsx("button",{onClick:()=>g(!1),style:{background:"rgba(255,255,255,0.05)",color:"white",padding:"8px",borderRadius:"50%",cursor:"pointer",border:"none"},children:e.jsx(Y,{size:20})})]}),e.jsx("div",{style:{padding:"20px"},children:C?e.jsx("div",{style:{textAlign:"center",padding:"40px",color:"white"},children:"Loading details..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"12px",marginBottom:"28px"},children:[e.jsxs("div",{style:{background:"rgba(14,165,233,0.08)",border:"1px solid rgba(14,165,233,0.2)",borderRadius:"12px",padding:"14px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[e.jsx(F,{size:14,color:"#38bdf8"}),e.jsx("span",{style:{fontSize:"10px",color:"#38bdf8",fontWeight:"800",textTransform:"uppercase"},children:"Wages & Bonus"})]}),e.jsxs("div",{style:{color:"white",fontWeight:"900",fontSize:"20px"},children:["₹",h.toLocaleString()]}),e.jsxs("div",{style:{fontSize:"10px",color:"rgba(255,255,255,0.4)",marginTop:"2px"},children:[n.workingDays||i?.breakdown?.length||0," duty days"]})]}),e.jsxs("div",{style:{background:"rgba(245,158,11,0.08)",border:"1px solid rgba(245,158,11,0.2)",borderRadius:"12px",padding:"14px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[e.jsx(X,{size:14,color:"#f59e0b"}),e.jsx("span",{style:{fontSize:"10px",color:"#f59e0b",fontWeight:"800",textTransform:"uppercase"},children:"Parking"})]}),e.jsxs("div",{style:{color:"white",fontWeight:"900",fontSize:"20px"},children:["₹",l.toLocaleString()]}),e.jsxs("div",{style:{fontSize:"10px",color:"rgba(255,255,255,0.4)",marginTop:"2px"},children:[i?.parkingEntries?.length||0," entries"]})]}),e.jsxs("div",{style:{background:"rgba(16,185,129,0.08)",border:"1px solid rgba(16,185,129,0.2)",borderRadius:"12px",padding:"14px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[e.jsx(O,{size:14,color:"#10b981"}),e.jsx("span",{style:{fontSize:"10px",color:"#10b981",fontWeight:"800",textTransform:"uppercase"},children:"Total Earned"})]}),e.jsxs("div",{style:{color:"white",fontWeight:"900",fontSize:"20px"},children:["₹",y.toLocaleString()]}),e.jsx("div",{style:{fontSize:"10px",color:"rgba(255,255,255,0.4)",marginTop:"2px"},children:"Wages + Parking"})]}),e.jsxs("div",{style:{background:"rgba(244,63,94,0.08)",border:"1px solid rgba(244,63,94,0.2)",borderRadius:"12px",padding:"14px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[e.jsx(_,{size:14,color:"#f43f5e"}),e.jsx("span",{style:{fontSize:"10px",color:"#f43f5e",fontWeight:"800",textTransform:"uppercase"},children:"Advances"})]}),e.jsxs("div",{style:{color:"white",fontWeight:"900",fontSize:"20px"},children:["₹",b.toLocaleString()]}),e.jsxs("div",{style:{fontSize:"10px",color:"rgba(255,255,255,0.4)",marginTop:"2px"},children:[i?.advances?.length||0," taken"]})]})]}),e.jsxs("div",{style:{background:d>=0?"linear-gradient(135deg, rgba(16,185,129,0.15), rgba(16,185,129,0.05))":"linear-gradient(135deg, rgba(244,63,94,0.15), rgba(244,63,94,0.05))",border:`1px solid ${d>=0?"rgba(16,185,129,0.3)":"rgba(244,63,94,0.3)"}`,borderRadius:"12px",padding:"16px 20px",marginBottom:"28px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",fontWeight:"800",color:d>=0?"#10b981":"#f43f5e",textTransform:"uppercase",marginBottom:"4px"},children:"Net Payable This Month"}),e.jsxs("div",{style:{fontSize:"10px",color:"rgba(255,255,255,0.4)"},children:["₹",y.toLocaleString()," earned − ₹",b.toLocaleString()," advances"]})]}),e.jsxs("div",{style:{color:d>=0?"#10b981":"#f43f5e",fontWeight:"900",fontSize:"26px"},children:["₹",Math.abs(d).toLocaleString()]})]}),e.jsx("h3",{style:{fontSize:"14px",color:"white",marginBottom:"15px",borderLeft:"3px solid #3b82f6",paddingLeft:"10px"},children:"Duty Calendar (Earnings)"}),e.jsx("div",{style:{overflowX:"auto",marginBottom:"30px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.05)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(255,255,255,0.02)",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("th",{style:{padding:"12px",textAlign:"left",color:"var(--text-muted)"},children:"Date"}),e.jsx("th",{style:{padding:"12px",textAlign:"right",color:"var(--text-muted)"},children:"Wage"}),e.jsx("th",{style:{padding:"12px",textAlign:"right",color:"var(--text-muted)"},children:"Bonus"}),e.jsx("th",{style:{padding:"12px",textAlign:"right",color:"white"},children:"Total"})]})}),e.jsxs("tbody",{children:[i?.breakdown?.map((t,r)=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.03)"},children:[e.jsxs("td",{style:{padding:"12px",color:"white"},children:[new Date(t.date).toLocaleDateString(),e.jsx("div",{style:{fontSize:"10px",color:"var(--text-muted)"},children:t.type||"Duty"}),t.remarks&&e.jsx("div",{style:{fontSize:"10px",color:"rgba(255,255,255,0.35)"},children:t.remarks})]}),e.jsxs("td",{style:{padding:"12px",textAlign:"right",color:"rgba(255,255,255,0.7)"},children:["₹",t.wage]}),e.jsxs("td",{style:{padding:"12px",textAlign:"right",color:"rgba(255,255,255,0.7)"},children:["₹",t.bonuses]}),e.jsxs("td",{style:{padding:"12px",textAlign:"right",color:"#10b981",fontWeight:"700"},children:["₹",t.total]})]},r)),i?.breakdown?.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",style:{padding:"20px",textAlign:"center",color:"var(--text-muted)"},children:"No completed duties found this month."})}),i?.breakdown?.length>0&&e.jsxs("tr",{style:{background:"rgba(14,165,233,0.05)",borderTop:"1px solid rgba(14,165,233,0.15)"},children:[e.jsx("td",{colSpan:"3",style:{padding:"12px",color:"#38bdf8",fontWeight:"700",fontSize:"12px"},children:"Wages Subtotal"}),e.jsxs("td",{style:{padding:"12px",textAlign:"right",color:"#38bdf8",fontWeight:"900"},children:["₹",h.toLocaleString()]})]})]})]})}),e.jsxs("h3",{style:{fontSize:"14px",color:"white",marginBottom:"15px",borderLeft:"3px solid #f59e0b",paddingLeft:"10px"},children:["Reimbursable Parking",l>0&&e.jsxs("span",{style:{marginLeft:"10px",color:"#f59e0b",fontWeight:"900"},children:["₹",l.toLocaleString()]})]}),e.jsx("div",{style:{overflowX:"auto",marginBottom:"30px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.05)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(255,255,255,0.02)",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("th",{style:{padding:"12px",textAlign:"left",color:"var(--text-muted)"},children:"Date"}),e.jsx("th",{style:{padding:"12px",textAlign:"left",color:"var(--text-muted)"},children:"Location / Remark"}),e.jsx("th",{style:{padding:"12px",textAlign:"left",color:"var(--text-muted)"},children:"Source"}),e.jsx("th",{style:{padding:"12px",textAlign:"right",color:"white"},children:"Amount"})]})}),e.jsxs("tbody",{children:[i?.parkingEntries?.length>0?i.parkingEntries.map((t,r)=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.03)"},children:[e.jsx("td",{style:{padding:"12px",color:"white"},children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{style:{padding:"12px",color:"var(--text-muted)"},children:t.location||t.remark||"—"}),e.jsx("td",{style:{padding:"12px"},children:e.jsx("span",{style:{fontSize:"10px",padding:"2px 8px",borderRadius:"4px",background:t.source==="Driver"?"rgba(14,165,233,0.1)":"rgba(245,158,11,0.1)",color:t.source==="Driver"?"#38bdf8":"#f59e0b",fontWeight:"700"},children:t.source||"Admin"})}),e.jsxs("td",{style:{padding:"12px",textAlign:"right",color:"#f59e0b",fontWeight:"700"},children:["₹",t.amount]})]},r)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",style:{padding:"20px",textAlign:"center",color:"var(--text-muted)"},children:"No parking entries this month."})}),i?.parkingEntries?.length>0&&e.jsxs("tr",{style:{background:"rgba(245,158,11,0.05)",borderTop:"1px solid rgba(245,158,11,0.15)"},children:[e.jsx("td",{colSpan:"3",style:{padding:"12px",color:"#f59e0b",fontWeight:"700",fontSize:"12px"},children:"Parking Subtotal"}),e.jsxs("td",{style:{padding:"12px",textAlign:"right",color:"#f59e0b",fontWeight:"900"},children:["₹",l.toLocaleString()]})]})]})]})}),e.jsx("h3",{style:{fontSize:"14px",color:"white",marginBottom:"15px",borderLeft:"3px solid #f43f5e",paddingLeft:"10px"},children:"Advances Taken (This Month)"}),e.jsx("div",{style:{overflowX:"auto",marginBottom:"20px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.05)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(255,255,255,0.02)",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("th",{style:{padding:"12px",textAlign:"left",color:"var(--text-muted)"},children:"Date"}),e.jsx("th",{style:{padding:"12px",textAlign:"left",color:"var(--text-muted)"},children:"Reason"}),e.jsx("th",{style:{padding:"12px",textAlign:"right",color:"white"},children:"Amount"})]})}),e.jsxs("tbody",{children:[i?.advances?.map((t,r)=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.03)"},children:[e.jsx("td",{style:{padding:"12px",color:"white"},children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{style:{padding:"12px",color:"var(--text-muted)"},children:t.remark}),e.jsxs("td",{style:{padding:"12px",textAlign:"right",color:"#f43f5e",fontWeight:"700"},children:["₹",t.amount]})]},r)),i?.advances?.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"3",style:{padding:"20px",textAlign:"center",color:"var(--text-muted)"},children:"No advances taken this month."})})]})]})})]})})]})})})]})};export{K as default};
