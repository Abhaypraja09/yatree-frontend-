import{b as i,j as e,af as B,J as L,A as y,m as f,X as N}from"./vendor-CWXhwHO8.js";import{b as R,i as b}from"./index-eGsc0syx.js";import{S as T}from"./SEO-CjfQuXn3.js";const P=()=>{const{selectedCompany:s}=R(),[u,j]=i.useState([]),[v,c]=i.useState(!0),[n,S]=i.useState(new Date().getMonth()+1),[l,w]=i.useState(new Date().getFullYear()),[o,A]=i.useState(""),[k,x]=i.useState(!1),[a,g]=i.useState(null),[z,h]=i.useState(!1);i.useEffect(()=>{s&&D()},[s,n,l]);const D=async()=>{if(s?._id){c(!0);try{const t=JSON.parse(localStorage.getItem("userInfo")),{data:r}=await b.get(`/api/admin/salary-summary/${s._id}?month=${n}&year=${l}`,{headers:{Authorization:`Bearer ${t.token}`}});j(r||[])}catch(t){console.error(t)}finally{c(!1)}}},m=async t=>{h(!0),x(!0),g(null);try{const r=JSON.parse(localStorage.getItem("userInfo")),{data:p}=await b.get(`/api/admin/salary-details/${t}?month=${n}&year=${l}`,{headers:{Authorization:`Bearer ${r.token}`}});g(p)}catch(r){console.error(r);const p=r.response?.data?.message||r.message||"Failed to fetch details";alert("Error: "+p),x(!1)}finally{h(!1)}},d=u.filter(t=>t.name?.toLowerCase().includes(o.toLowerCase())||t.mobile?.includes(o)),W=d.reduce((t,r)=>t+(r.netPayable||0),0);return e.jsxs("div",{className:"container-fluid",style:{paddingBottom:"40px"},children:[e.jsx(T,{title:"Driver Payroll",description:"View driver salary reports, duty days, and advances."}),e.jsxs("header",{className:"flex-resp",style:{justifyContent:"space-between",flexWrap:"wrap",gap:"20px",padding:"30px 0",marginBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("div",{style:{width:"clamp(40px, 10vw, 50px)",height:"clamp(40px, 10vw, 50px)",background:"linear-gradient(135deg, white, #f8fafc)",borderRadius:"16px",padding:"8px",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},children:e.jsx(B,{size:28,color:"#10b981"})}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[e.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:"#10b981",boxShadow:"0 0 8px #10b981"}}),e.jsx("span",{style:{fontSize:"clamp(9px, 2.5vw, 10px)",fontWeight:"800",color:"rgba(255,255,255,0.5)",letterSpacing:"1px",textTransform:"uppercase"},children:"Financials"})]}),e.jsxs("h1",{style:{color:"white",fontSize:"clamp(24px, 5vw, 32px)",fontWeight:"900",margin:0,letterSpacing:"-1px"},children:["Driver ",e.jsx("span",{className:"text-gradient-green",children:"Salaries"})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",flexWrap:"wrap"},children:[e.jsx("select",{value:n,onChange:t=>S(Number(t.target.value)),className:"glass-card",style:{padding:"10px",border:"1px solid rgba(255,255,255,0.1)",color:"white",background:"#0f172a",borderRadius:"10px"},children:Array.from({length:12},(t,r)=>r+1).map(t=>e.jsx("option",{value:t,children:new Date(0,t-1).toLocaleString("default",{month:"long"})},t))}),e.jsx("select",{value:l,onChange:t=>w(Number(t.target.value)),className:"glass-card",style:{padding:"10px",border:"1px solid rgba(255,255,255,0.1)",color:"white",background:"#0f172a",borderRadius:"10px"},children:[2024,2025,2026,2027].map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsxs("div",{className:"glass-card",style:{padding:"0",display:"flex",alignItems:"center",borderRadius:"14px",border:"1px solid rgba(255,255,255,0.08)"},children:[e.jsx(L,{size:18,style:{margin:"0 15px",color:"rgba(255,255,255,0.4)"}}),e.jsx("input",{type:"text",placeholder:"Search...",value:o,onChange:t=>A(t.target.value),style:{background:"transparent",border:"none",color:"white",height:"45px",outline:"none"}})]})]})]}),e.jsxs("div",{className:"glass-card",style:{padding:"20px",marginBottom:"30px",background:"linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(16, 185, 129, 0.05) 100%)",border:"1px solid rgba(16, 185, 129, 0.2)",display:"inline-block"},children:[e.jsxs("p",{style:{fontSize:"11px",fontWeight:"800",color:"rgba(16, 185, 129, 0.8)",marginBottom:"4px",textTransform:"uppercase"},children:["Total Net Payable (",new Date(0,n-1).toLocaleString("default",{month:"short"})," ",l,")"]}),e.jsxs("h3",{style:{fontSize:"28px",fontWeight:"900",color:"white"},children:["₹ ",W.toLocaleString()]})]}),e.jsx("div",{className:"glass-card hide-mobile",style:{padding:"0",overflowX:"auto",border:"1px solid rgba(255,255,255,0.05)",background:"transparent"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:"0 8px",padding:"0 10px",minWidth:"800px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{textAlign:"left"},children:[e.jsx("th",{style:{padding:"15px 25px",color:"var(--text-muted)",fontSize:"10px",fontWeight:"900",textTransform:"uppercase",letterSpacing:"1px"},children:"Driver"}),e.jsx("th",{style:{padding:"15px 25px",color:"var(--text-muted)",fontSize:"10px",fontWeight:"900",textTransform:"uppercase",letterSpacing:"1px"},children:"Daily Wage"}),e.jsx("th",{style:{padding:"15px 25px",color:"var(--text-muted)",fontSize:"10px",fontWeight:"900",textTransform:"uppercase",letterSpacing:"1px"},children:"Duty Days"}),e.jsx("th",{style:{padding:"15px 25px",color:"var(--text-muted)",fontSize:"10px",fontWeight:"900",textTransform:"uppercase",letterSpacing:"1px"},children:"Total Earnings"}),e.jsx("th",{style:{padding:"15px 25px",color:"var(--text-muted)",fontSize:"10px",fontWeight:"900",textTransform:"uppercase",letterSpacing:"1px"},children:"Advances (This Month)"}),e.jsx("th",{style:{padding:"15px 25px",color:"var(--text-muted)",fontSize:"10px",fontWeight:"900",textTransform:"uppercase",letterSpacing:"1px"},children:"Pending Balance"}),e.jsx("th",{style:{padding:"15px 25px",color:"#10b981",fontSize:"10px",fontWeight:"900",textTransform:"uppercase",letterSpacing:"1px"},children:"Net Payable"})]})}),e.jsx("tbody",{children:e.jsx(y,{children:v?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",style:{textAlign:"center",padding:"40px",color:"white"},children:"Loading report..."})}):d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",style:{textAlign:"center",padding:"40px",color:"var(--text-muted)"},children:"No records found for this period."})}):d.map((t,r)=>e.jsxs(f.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:r*.05},onClick:()=>m(t.driverId),className:"glass-card-hover-effect",style:{background:"rgba(30, 41, 59, 0.4)",borderRadius:"12px",cursor:"pointer"},children:[e.jsxs("td",{style:{padding:"20px 25px",borderTopLeftRadius:"12px",borderBottomLeftRadius:"12px"},children:[e.jsx("div",{style:{fontWeight:"700",color:"white"},children:t.name}),e.jsx("div",{style:{fontSize:"11px",color:"var(--text-muted)"},children:t.mobile})]}),e.jsxs("td",{style:{padding:"20px 25px",color:"rgba(255,255,255,0.7)",fontWeight:"600",fontFamily:"monospace"},children:["₹ ",t.dailyWage]}),e.jsx("td",{style:{padding:"20px 25px",color:"white",fontWeight:"800"},children:t.workingDays||0}),e.jsxs("td",{style:{padding:"20px 25px",color:"#38bdf8",fontWeight:"700"},children:["₹ ",t.totalEarned]}),e.jsxs("td",{style:{padding:"20px 25px",color:"#f43f5e",fontWeight:"700"},children:["₹ ",t.totalAdvances]}),e.jsxs("td",{style:{padding:"20px 25px",color:"#f59e0b",fontWeight:"700"},children:["₹ ",t.pendingAdvance]}),e.jsxs("td",{style:{padding:"20px 25px",borderTopRightRadius:"12px",borderBottomRightRadius:"12px",color:"#10b981",fontWeight:"900",fontSize:"15px"},children:["₹ ",t.netPayable]})]},t.driverId))})})]})}),e.jsx("div",{className:"show-mobile",style:{display:"flex",flexDirection:"column",gap:"15px"},children:d.map(t=>e.jsxs("div",{className:"glass-card",style:{padding:"20px",cursor:"pointer"},onClick:()=>m(t.driverId),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"15px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,color:"white",fontSize:"16px"},children:t.name}),e.jsx("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"12px"},children:t.mobile})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("p",{style:{margin:0,fontSize:"10px",fontWeight:"800",color:"#10b981"},children:"NET PAYABLE"}),e.jsxs("h3",{style:{margin:0,color:"#10b981",fontSize:"18px"},children:["₹ ",t.netPayable]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",fontSize:"13px"},children:[e.jsxs("div",{style:{background:"rgba(255,255,255,0.03)",padding:"10px",borderRadius:"8px"},children:[e.jsx("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"10px"},children:"DAILY WAGE"}),e.jsxs("p",{style:{margin:"4px 0 0",color:"rgba(255,255,255,0.7)",fontWeight:"600"},children:["₹ ",t.dailyWage]})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.03)",padding:"10px",borderRadius:"8px"},children:[e.jsx("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"10px"},children:"DUTY DAYS"}),e.jsx("p",{style:{margin:"4px 0 0",color:"white",fontWeight:"700"},children:t.workingDays})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.03)",padding:"10px",borderRadius:"8px"},children:[e.jsx("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"10px"},children:"TOTAL EARNINGS"}),e.jsxs("p",{style:{margin:"4px 0 0",color:"white",fontWeight:"700"},children:["₹ ",t.totalEarned]})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.03)",padding:"10px",borderRadius:"8px"},children:[e.jsx("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"10px"},children:"ADVANCES"}),e.jsxs("p",{style:{margin:"4px 0 0",color:"#f43f5e",fontWeight:"700"},children:["₹ ",t.totalAdvances]})]})]})]},t.driverId))}),e.jsx(y,{children:k&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.8)",backdropFilter:"blur(8px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,padding:"15px"},children:e.jsxs(f.div,{initial:{scale:.95,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:20},className:"glass-card",style:{padding:"0",width:"100%",maxWidth:"800px",maxHeight:"90vh",overflowY:"auto",border:"1px solid rgba(255,255,255,0.1)",background:"#0f172a"},children:[e.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid rgba(255,255,255,0.05)",display:"flex",justifyContent:"space-between",alignItems:"center",background:"linear-gradient(to right, rgba(255,255,255,0.02), transparent)",position:"sticky",top:0,backdropFilter:"blur(10px)",zIndex:5},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{color:"white",fontSize:"18px",fontWeight:"800",margin:0},children:"Salary Breakdown"}),a?.driver?.[0]?.name&&e.jsx("p",{style:{color:"var(--primary)",fontSize:"13px",margin:"4px 0 0",fontWeight:"600"},children:a.driver[0].name})]}),e.jsx("button",{onClick:()=>x(!1),style:{background:"rgba(255,255,255,0.05)",color:"white",padding:"8px",borderRadius:"50%",cursor:"pointer",border:"none"},children:e.jsx(N,{size:20})})]}),e.jsx("div",{style:{padding:"20px"},children:z?e.jsx("div",{style:{textAlign:"center",padding:"40px",color:"white"},children:"Loading details..."}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{style:{fontSize:"14px",color:"white",marginBottom:"15px",borderLeft:"3px solid #3b82f6",paddingLeft:"10px"},children:"Duty Calendar (Earnings)"}),e.jsx("div",{style:{overflowX:"auto",marginBottom:"30px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.05)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(255,255,255,0.02)",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("th",{style:{padding:"12px",textAlign:"left",color:"var(--text-muted)"},children:"Date"}),e.jsx("th",{style:{padding:"12px",textAlign:"right",color:"var(--text-muted)"},children:"Wage"}),e.jsx("th",{style:{padding:"12px",textAlign:"right",color:"var(--text-muted)"},children:"Bonus"}),e.jsx("th",{style:{padding:"12px",textAlign:"right",color:"var(--text-muted)"},children:"Misc."}),e.jsx("th",{style:{padding:"12px",textAlign:"right",color:"white"},children:"Total"})]})}),e.jsxs("tbody",{children:[a?.breakdown?.map((t,r)=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.03)"},children:[e.jsxs("td",{style:{padding:"12px",color:"white"},children:[new Date(t.date).toLocaleDateString(),e.jsx("div",{style:{fontSize:"10px",color:"var(--text-muted)"},children:t.type||"Manual Entry"}),t.remarks&&e.jsx("div",{style:{fontSize:"10px",color:"var(--text-muted)"},children:t.remarks})]}),e.jsxs("td",{style:{padding:"12px",textAlign:"right",color:"rgba(255,255,255,0.7)"},children:["₹",t.wage]}),e.jsxs("td",{style:{padding:"12px",textAlign:"right",color:"rgba(255,255,255,0.7)"},children:["₹",t.bonuses]}),e.jsxs("td",{style:{padding:"12px",textAlign:"right",color:"rgba(255,255,255,0.7)"},children:["₹",t.parking||0]}),e.jsxs("td",{style:{padding:"12px",textAlign:"right",color:"#10b981",fontWeight:"700"},children:["₹",t.total]})]},r)),a?.breakdown?.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"5",style:{padding:"20px",textAlign:"center",color:"var(--text-muted)"},children:"No completed duties found this month."})})]})]})}),a?.parkingEntries?.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{style:{fontSize:"14px",color:"white",marginBottom:"15px",borderLeft:"3px solid #f59e0b",paddingLeft:"10px"},children:"Reimbursable Parking (Scanned/Admin Added)"}),e.jsx("div",{style:{overflowX:"auto",marginBottom:"30px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.05)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(255,255,255,0.02)",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("th",{style:{padding:"12px",textAlign:"left",color:"var(--text-muted)"},children:"Date"}),e.jsx("th",{style:{padding:"12px",textAlign:"left",color:"var(--text-muted)"},children:"Location/Remark"}),e.jsx("th",{style:{padding:"12px",textAlign:"right",color:"white"},children:"Amount"})]})}),e.jsx("tbody",{children:a.parkingEntries.map((t,r)=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.03)"},children:[e.jsx("td",{style:{padding:"12px",color:"white"},children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{style:{padding:"12px",color:"var(--text-muted)"},children:t.location||t.remark||"Parking"}),e.jsxs("td",{style:{padding:"12px",textAlign:"right",color:"#f59e0b",fontWeight:"700"},children:["₹",t.amount]})]},r))})]})})]}),e.jsx("h3",{style:{fontSize:"14px",color:"white",marginBottom:"15px",borderLeft:"3px solid #f43f5e",paddingLeft:"10px"},children:"Advances Taken (This Month)"}),e.jsx("div",{style:{overflowX:"auto",marginBottom:"20px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.05)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(255,255,255,0.02)",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("th",{style:{padding:"12px",textAlign:"left",color:"var(--text-muted)"},children:"Date"}),e.jsx("th",{style:{padding:"12px",textAlign:"left",color:"var(--text-muted)"},children:"Reason"}),e.jsx("th",{style:{padding:"12px",textAlign:"right",color:"white"},children:"Amount"})]})}),e.jsxs("tbody",{children:[a?.advances?.map((t,r)=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.03)"},children:[e.jsx("td",{style:{padding:"12px",color:"white"},children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{style:{padding:"12px",color:"var(--text-muted)"},children:t.remark}),e.jsxs("td",{style:{padding:"12px",textAlign:"right",color:"#f43f5e",fontWeight:"700"},children:["₹",t.amount]})]},r)),a?.advances?.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"3",style:{padding:"20px",textAlign:"center",color:"var(--text-muted)"},children:"No advances taken this month."})})]})]})})]})})]})})})]})};export{P as default};
