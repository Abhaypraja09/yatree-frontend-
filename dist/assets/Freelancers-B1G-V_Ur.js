import{b as r,j as e,H as we,I as K,G as ke,J as Ne,m as N,K as ze,E as te,A as We,X as De,x as Ie,l as Ce}from"./vendor-C_ywCXHK.js";import{b as Te,i as m}from"./index-BIJFZ0ug.js";import{u as X,w as Ae}from"./excel-B9D0dd6c.js";import{S as Oe}from"./SEO-BK4B2ZiL.js";const _e=()=>{const{selectedCompany:a}=Te(),[x,d]=r.useState([]),[z,_]=r.useState([]),[W,D]=r.useState(!0),[b,ie]=r.useState(""),[re,P]=r.useState(!1),[ne,E]=r.useState(!1),[ae,I]=r.useState(!1),[se,C]=r.useState(!1),[v,T]=r.useState(null),[Y,H]=r.useState(null),[g,le]=r.useState("All"),[M,oe]=r.useState([]),[f,A]=r.useState({name:"",mobile:"",licenseNumber:"",dailyWage:""}),[y,O]=r.useState({name:"",mobile:"",licenseNumber:"",dailyWage:""}),[c,h]=r.useState({vehicleId:"",km:"",date:new Date(new Date().getTime()-new Date().getTimezoneOffset()*6e4).toISOString().slice(0,10),time:new Date(new Date().getTime()-new Date().getTimezoneOffset()*6e4).toISOString().slice(0,16),pickUpLocation:""}),[n,p]=r.useState({km:"",time:new Date().toISOString().slice(0,16),fuelAmount:"0",parkingAmount:"0",review:"",dailyWage:"",dropLocation:""}),de=()=>{const t=new Date;return t.setDate(t.getDate()-180),t.toISOString().split("T")[0]},ce=()=>new Date().toISOString().split("T")[0],[$,pe]=r.useState(de()),[U,xe]=r.useState(ce()),[B,u]=r.useState(!1),[ge,q]=r.useState(""),[G,j]=r.useState({type:"",text:""});r.useEffect(()=>{a&&(S(),J(),V())},[a,$,U]);const V=async()=>{if(a?._id)try{const t=JSON.parse(localStorage.getItem("userInfo")),{data:i}=await m.get(`/api/admin/reports/${a._id}?from=${$}&to=${U}`,{headers:{Authorization:`Bearer ${t.token}`}});oe((i.attendance||[]).filter(l=>l.driver?.isFreelancer))}catch(t){console.error(t)}},S=async()=>{if(a?._id){D(!0);try{const t=JSON.parse(localStorage.getItem("userInfo")),{data:i}=await m.get(`/api/admin/drivers/${a._id}?isFreelancer=true&usePagination=false`,{headers:{Authorization:`Bearer ${t.token}`}});d(i.drivers||[])}catch(t){console.error(t)}finally{D(!1)}}},J=async()=>{if(a?._id)try{const t=JSON.parse(localStorage.getItem("userInfo")),{data:i}=await m.get(`/api/admin/vehicles/${a._id}?usePagination=false`,{headers:{Authorization:`Bearer ${t.token}`}});_(i.vehicles||[])}catch(t){console.error(t)}},he=async t=>{t.preventDefault(),u(!0);try{const i=JSON.parse(localStorage.getItem("userInfo"));await m.post("/api/admin/drivers",{...f,companyId:a._id,isFreelancer:!0},{headers:{Authorization:`Bearer ${i.token}`}}),j({type:"success",text:"Freelancer added successfully!"}),setTimeout(()=>{P(!1),A({name:"",mobile:"",licenseNumber:"",dailyWage:""}),j({type:"",text:""}),S()},1e3)}catch(i){j({type:"error",text:i.response?.data?.message||"Failed"})}finally{u(!1)}},ue=async t=>{t.preventDefault(),u(!0);try{const i=JSON.parse(localStorage.getItem("userInfo"));await m.post("/api/admin/freelancers/punch-in",{...c,driverId:v._id},{headers:{Authorization:`Bearer ${i.token}`}}),I(!1);const l=new Date(new Date().getTime()-new Date().getTimezoneOffset()*6e4).toISOString();h({vehicleId:"",km:"",date:l.slice(0,10),time:l.slice(0,16),pickUpLocation:""}),S(),J(),V()}catch(i){alert(i.response?.data?.message||"Error")}finally{u(!1)}},me=async t=>{t.preventDefault(),u(!0);try{const i=JSON.parse(localStorage.getItem("userInfo"));await m.post("/api/admin/freelancers/punch-out",{...n,driverId:v._id},{headers:{Authorization:`Bearer ${i.token}`}}),C(!1);const l=new Date().toISOString().slice(0,16);p({km:"",time:l,fuelAmount:"0",parkingAmount:"0",review:"",dailyWage:"",dropLocation:""}),S(),J(),V()}catch(i){alert(i.response?.data?.message||"Error")}finally{u(!1)}},fe=async t=>{t.preventDefault(),u(!0);try{const i=JSON.parse(localStorage.getItem("userInfo"));await m.put(`/api/admin/drivers/${Y._id}`,y,{headers:{Authorization:`Bearer ${i.token}`}}),j({type:"success",text:"Freelancer updated successfully!"}),setTimeout(()=>{E(!1),H(null),j({type:"",text:""}),S()},1e3)}catch(i){j({type:"error",text:i.response?.data?.message||"Update failed"})}finally{u(!1)}},Q=t=>{H(t),O({name:t.name,mobile:t.mobile,licenseNumber:t.licenseNumber||"",dailyWage:t.dailyWage||""}),E(!0)},Z=async t=>{if(window.confirm("Delete this freelancer?"))try{const i=JSON.parse(localStorage.getItem("userInfo"));await m.delete(`/api/admin/drivers/${t}`,{headers:{Authorization:`Bearer ${i.token}`}}),S()}catch{alert("Error deleting")}},ee=x.filter(t=>g==="All"||t._id===g),L=ee.filter(t=>t.tripStatus==="active"),w=ee.filter(t=>t.tripStatus!=="active").filter(t=>t.name?.toLowerCase().includes(b.toLowerCase())||t.mobile?.includes(b)||t.licenseNumber?.toLowerCase().includes(b.toLowerCase())),k=M.filter(t=>g==="All"||t.driver?._id===g||t.driver===g),ye=k.reduce((t,i)=>t+(Number(i.dailyWage)||0),0),be=g==="All"?"All Freelancers":x.find(t=>t._id===g)?.name,ve=[...new Set(M.map(t=>t.pickUpLocation).filter(Boolean))].sort(),je=[...new Set(M.map(t=>t.dropLocation).filter(Boolean))].sort(),Se=()=>{if(k.length===0)return alert("No data to download");const t=k.map(s=>({Date:s.date,"Driver Name":s.driver?.name||"N/A",Car:s.vehicle?.carNumber?s.vehicle.carNumber.slice(-4):"N/A","In Time":s.punchIn?.time?new Date(s.punchIn.time).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0}):"-","Out Time":s.punchOut?.time?new Date(s.punchOut.time).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0}):"-","Total KM":s.punchOut?.km-s.punchIn?.km||0,"Pick-up":s.pickUpLocation||"-",Drop:s.dropLocation||"-",Salary:s.dailyWage||0,Fuel:s.fuel?.amount||0,"Parking/Toll":s.punchOut?.tollParkingAmount||0,Remarks:s.punchOut?.remarks||""})),i=X.json_to_sheet(t),l=X.book_new();X.book_append_sheet(l,i,"Freelancer Duties"),Ae(l,`Freelancer_Report_${new Date().toLocaleDateString()}.xlsx`)};return e.jsxs("div",{className:"container-fluid",style:{paddingBottom:"40px"},children:[e.jsx(Oe,{title:"Freelancer Fleet Network",description:"Onboard and manage freelance drivers for temporary duties and peak demand management."}),e.jsxs("header",{style:{paddingBottom:"30px",borderBottom:"1px solid rgba(255,255,255,0.05)",marginBottom:"30px"},children:[e.jsxs("div",{className:"flex-resp",style:{justifyContent:"space-between",alignItems:"center",gap:"20px"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"8px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#6366f1",boxShadow:"0 0 10px #6366f1"}}),e.jsx("span",{style:{fontSize:"11px",fontWeight:"900",color:"rgba(255,255,255,0.4)",letterSpacing:"2px",textTransform:"uppercase"},children:"External Personnel"})]}),e.jsxs("h1",{className:"resp-title",style:{margin:0,fontWeight:"900",letterSpacing:"-1.5px",fontSize:"clamp(28px, 5vw, 36px)"},children:["Freelancer ",e.jsx("span",{style:{color:"var(--secondary)"},children:"Net"})]}),e.jsxs("p",{className:"resp-subtitle",style:{marginTop:"4px",fontSize:"13px"},children:["Network of ",e.jsx("b",{children:x.length})," verified external professionals"]})]}),e.jsxs("div",{className:"flex-resp",style:{gap:"12px",flex:1,justifyContent:"flex-end",maxWidth:"800px"},children:[e.jsxs("div",{style:{position:"relative",flex:"1",minWidth:"180px"},children:[e.jsx(we,{size:16,style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsxs("select",{value:g,onChange:t=>le(t.target.value),className:"input-field",style:{height:"48px",paddingLeft:"44px",marginBottom:0,fontSize:"13px",appearance:"auto",background:"rgba(255,255,255,0.03)"},children:[e.jsx("option",{value:"All",style:{color:"#1e293b"},children:"All Drivers"}),x.map(t=>e.jsx("option",{value:t._id,style:{color:"#1e293b"},children:t.name},t._id))]})]}),e.jsxs("div",{style:{position:"relative",flex:"1",minWidth:"180px"},children:[e.jsx(K,{size:16,style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search driver...",value:b,onChange:t=>ie(t.target.value),className:"input-field",style:{paddingLeft:"44px",marginBottom:0,height:"48px",fontSize:"13px",background:"rgba(255,255,255,0.03)"}})]})]})]}),e.jsxs("div",{className:"flex-resp",style:{marginTop:"20px",justifyContent:"space-between",gap:"15px",alignItems:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",gap:"10px",flex:"1",width:"100%",flexWrap:"wrap"},children:[e.jsxs("div",{style:{flex:1,minWidth:"130px"},children:[e.jsx("label",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:"800",marginBottom:"5px",display:"block"},children:"FROM"}),e.jsx("input",{type:"date",value:$,onChange:t=>pe(t.target.value),className:"input-field",style:{height:"44px",marginBottom:0,fontSize:"12px",width:"100%"}})]}),e.jsxs("div",{style:{flex:1,minWidth:"130px"},children:[e.jsx("label",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:"800",marginBottom:"5px",display:"block"},children:"TO"}),e.jsx("input",{type:"date",value:U,onChange:t=>xe(t.target.value),className:"input-field",style:{height:"44px",marginBottom:0,fontSize:"12px",width:"100%"}})]})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",width:"100%",justifyContent:"flex-end",flexWrap:"wrap"},children:[e.jsxs("button",{onClick:Se,className:"btn-primary",style:{height:"48px",padding:"0 15px",background:"rgba(16, 185, 129, 0.1)",color:"#10b981",border:"1px solid rgba(16, 185, 129, 0.1)",fontWeight:"800",fontSize:"12px",flex:1,minWidth:"120px"},children:[e.jsx(ke,{size:18})," ",e.jsx("span",{className:"hide-mobile",children:"EXCEL"})]}),e.jsxs("button",{onClick:()=>P(!0),className:"btn-primary",style:{height:"48px",padding:"0 20px",fontWeight:"800",fontSize:"12px",display:"flex",alignItems:"center",gap:"6px",flex:1,minWidth:"130px"},children:[e.jsx(Ne,{size:18})," ",e.jsx("span",{style:{whiteSpace:"nowrap"},children:"Add Driver"})]})]})]})]}),g!=="All"&&e.jsxs(N.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"glass-card",style:{marginBottom:"35px",padding:"24px",display:"flex",flexWrap:"wrap",gap:"20px",justifyContent:"space-between",alignItems:"center",background:"linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(30, 41, 59, 0.8) 100%)",borderLeft:"4px solid #6366f1",borderRadius:"20px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"18px"},children:[e.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"16px",background:"rgba(99, 102, 241, 0.1)",display:"flex",justifyContent:"center",alignItems:"center",color:"#818cf8",border:"1px solid rgba(99, 102, 241, 0.2)"},children:e.jsx(ze,{size:28})}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#818cf8",fontSize:"11px",fontWeight:"900",textTransform:"uppercase",letterSpacing:"1.5px",marginBottom:"4px"},children:"Accumulated Ledger"}),e.jsx("h2",{style:{color:"white",fontSize:"24px",fontWeight:"900",margin:0,letterSpacing:"-0.5px"},children:be})]})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:"11px",color:"var(--text-muted)",fontWeight:"800",letterSpacing:"1px",marginBottom:"4px"},children:"TOTAL WAGE PAYABLE"}),e.jsxs("div",{style:{fontSize:"32px",fontWeight:"900",color:"#6366f1",letterSpacing:"-1px"},children:[e.jsx("span",{style:{fontSize:"20px",marginRight:"4px",opacity:.6},children:"₹"}),ye.toLocaleString("en-IN")]})]})]}),L.length>0&&e.jsxs("div",{style:{marginBottom:"40px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"15px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#f43f5e",boxShadow:"0 0 10px #f43f5e"}}),e.jsxs("h2",{style:{color:"white",fontSize:"16px",fontWeight:"800",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:["Currently On Duty (",L.length,")"]})]}),e.jsx("div",{className:"glass-card hide-mobile",style:{padding:"0",overflowX:"auto",border:"1px solid rgba(244, 63, 94, 0.2)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",color:"white",minWidth:"700px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(244, 63, 94, 0.05)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Driver"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Contact"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Assigned Vehicle"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Start Odo"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",textAlign:"right"},children:"Action"})]})}),e.jsx("tbody",{children:L.map(t=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.03)"},children:[e.jsx("td",{style:{padding:"18px 25px",fontWeight:"700",fontSize:"15px"},children:t.name}),e.jsx("td",{style:{padding:"18px 25px",fontSize:"14px"},children:t.mobile}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsx("div",{style:{color:"var(--primary)",fontWeight:"800",fontSize:"14px"},children:t.assignedVehicle?.carNumber?.split("#")[0]})}),e.jsxs("td",{style:{padding:"18px 25px",fontSize:"14px",color:"var(--text-muted)"},children:[t.activeAttendance?.punchIn?.km||"-"," KM"]}),e.jsx("td",{style:{padding:"18px 25px",textAlign:"right"},children:e.jsx("button",{onClick:()=>{const i=new Date(new Date().getTime()-new Date().getTimezoneOffset()*6e4).toISOString().slice(0,16);T(t),p(l=>({...l,time:i})),C(!0)},className:"btn-primary",style:{background:"rgba(244, 63, 94, 0.1)",color:"#f43f5e",border:"1px solid rgba(244, 63, 94, 0.1)",padding:"8px 16px",fontSize:"12px",fontWeight:"800",textTransform:"uppercase"},children:"Punch Out"})})]},t._id))})]})}),e.jsx("div",{className:"show-mobile",children:e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:L.map(t=>e.jsxs(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"glass-card",style:{padding:"16px",background:"rgba(244, 63, 94, 0.05)",border:"1px solid rgba(244, 63, 94, 0.2)",borderRadius:"14px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[e.jsx("div",{style:{fontWeight:"800",color:"white",fontSize:"16px"},children:t.name}),e.jsx("div",{style:{fontSize:"12px",color:"var(--text-muted)"},children:t.mobile})]}),e.jsxs("div",{style:{padding:"12px",background:"rgba(0,0,0,0.2)",borderRadius:"10px",marginBottom:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"10px",color:"var(--text-muted)",textTransform:"uppercase",fontWeight:"800"},children:"Vehicle"}),e.jsx("div",{style:{color:"var(--primary)",fontWeight:"800",fontSize:"14px"},children:t.assignedVehicle?.carNumber?.split("#")[0]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"10px",color:"var(--text-muted)",textTransform:"uppercase",fontWeight:"800",textAlign:"right"},children:"Start KM"}),e.jsx("div",{style:{color:"white",fontWeight:"700",fontSize:"14px",textAlign:"right"},children:t.activeAttendance?.punchIn?.km||"-"})]})]}),e.jsx("button",{onClick:()=>{const i=new Date(new Date().getTime()-new Date().getTimezoneOffset()*6e4).toISOString().slice(0,16);T(t),p(l=>({...l,time:i})),C(!0)},className:"btn-primary",style:{width:"100%",background:"#f43f5e",color:"white",padding:"12px",borderRadius:"10px",fontSize:"14px",fontWeight:"800"},children:"Punch Out"})]},t._id))})})]}),e.jsxs("div",{style:{marginTop:"30px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"15px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#10b981"}}),e.jsxs("h2",{style:{color:"white",fontSize:"16px",fontWeight:"800",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:["Available Freelancers (",w.length,")"]})]}),e.jsx("div",{className:"glass-card hide-mobile",style:{padding:"0",overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",color:"white",minWidth:"700px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(255,255,255,0.02)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Name"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Mobile"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Rate (₹)"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"License"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:W?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",style:{textAlign:"center",padding:"60px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"10px",color:"var(--text-muted)"},children:[e.jsx("div",{className:"spinner"}),e.jsx("span",{children:"Syncing available records..."})]})})}):w.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"5",style:{textAlign:"center",padding:"60px",color:"var(--text-muted)"},children:[e.jsx("div",{style:{background:"rgba(255,255,255,0.02)",width:"60px",height:"60px",borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",margin:"0 auto 15px"},children:e.jsx(K,{size:22,style:{opacity:.3}})}),e.jsx("p",{style:{fontSize:"14px",margin:0},children:"No available freelancers found."})]})}):w.map(t=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.03)"},children:[e.jsx("td",{style:{padding:"18px 25px",fontWeight:"700",fontSize:"15px"},children:t.name}),e.jsx("td",{style:{padding:"18px 25px",fontSize:"14px"},children:t.mobile}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsxs("div",{style:{color:"#10b981",fontWeight:"800",fontSize:"14px"},children:["₹",t.dailyWage||0]})}),e.jsx("td",{style:{padding:"18px 25px",fontSize:"13px",color:"var(--text-muted)"},children:t.licenseNumber||"Not Provided"}),e.jsx("td",{style:{padding:"18px 25px",textAlign:"right"},children:e.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>{const i=new Date(new Date().getTime()-new Date().getTimezoneOffset()*6e4);T(t),h({vehicleId:"",km:"",date:i.toISOString().slice(0,10),time:i.toISOString().slice(0,16),pickUpLocation:""}),q(""),I(!0)},className:"btn-primary",style:{background:"rgba(16, 185, 129, 0.1)",color:"#10b981",border:"1px solid rgba(16, 185, 129, 0.1)",padding:"8px 16px",fontSize:"12px",fontWeight:"800",textTransform:"uppercase"},children:"Assign Duty"}),e.jsx("button",{onClick:()=>Q(t),className:"btn-primary",style:{background:"rgba(14, 165, 233, 0.1)",color:"var(--primary)",border:"1px solid rgba(14, 165, 233, 0.1)",padding:"8px 12px",fontSize:"12px",fontWeight:"800"},children:"Edit"}),e.jsx("button",{onClick:()=>Z(t._id),style:{color:"#f43f5e",background:"rgba(244, 63, 94, 0.05)",padding:"8px",borderRadius:"8px",border:"1px solid rgba(244, 63, 94, 0.1)"},children:e.jsx(te,{size:16})})]})})]},t._id))})]})}),e.jsx("div",{className:"show-mobile",children:W?e.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"40px",color:"var(--text-muted)"},children:e.jsx("div",{className:"spinner"})}):w.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"var(--text-muted)",background:"rgba(255,255,255,0.02)",borderRadius:"16px"},children:[e.jsx(K,{size:22,style:{opacity:.3,marginBottom:"10px"}}),e.jsx("p",{children:"No available freelancers."})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:w.map(t=>e.jsxs(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"glass-card",style:{padding:"16px",background:"rgba(30, 41, 59, 0.4)",borderRadius:"14px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"800",color:"white",fontSize:"16px"},children:t.name}),e.jsx("div",{style:{fontSize:"12px",color:"var(--text-muted)"},children:t.mobile})]}),e.jsxs("div",{style:{background:"rgba(16, 185, 129, 0.1)",color:"#10b981",padding:"4px 8px",borderRadius:"6px",fontSize:"12px",fontWeight:"800"},children:["₹",t.dailyWage||0]})]}),e.jsxs("div",{style:{fontSize:"12px",color:"var(--text-muted)",marginBottom:"15px"},children:["License: ",e.jsx("span",{style:{color:"white"},children:t.licenseNumber||"N/A"})]}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{onClick:()=>{const i=new Date(new Date().getTime()-new Date().getTimezoneOffset()*6e4);T(t),h({vehicleId:"",km:"",date:i.toISOString().slice(0,10),time:i.toISOString().slice(0,16),pickUpLocation:""}),q(""),I(!0)},className:"btn-primary",style:{flex:2,background:"rgba(16, 185, 129, 0.1)",color:"#10b981",border:"1px solid rgba(16, 185, 129, 0.1)",padding:"10px",fontSize:"12px",fontWeight:"800",textTransform:"uppercase",borderRadius:"10px"},children:"Assign Duty"}),e.jsx("button",{onClick:()=>Q(t),style:{flex:1,background:"rgba(14, 165, 233, 0.1)",color:"var(--primary)",border:"1px solid rgba(14, 165, 233, 0.1)",padding:"10px",fontSize:"12px",fontWeight:"800",borderRadius:"10px"},children:"Edit"}),e.jsx("button",{onClick:()=>Z(t._id),style:{color:"#f43f5e",background:"rgba(244, 63, 94, 0.05)",padding:"10px",borderRadius:"10px",border:"1px solid rgba(244, 63, 94, 0.1)"},children:e.jsx(te,{size:16})})]})]},t._id))})})]}),e.jsxs("div",{style:{marginTop:"40px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"20px"},children:[e.jsx("div",{style:{width:"4px",height:"16px",background:"var(--secondary)",borderRadius:"2px"}}),e.jsx("h2",{style:{fontSize:"18px",fontWeight:"900",margin:0,letterSpacing:"0.5px"},children:"Recent Completed Duties"})]}),e.jsxs("div",{className:"grid-1-2-2-3",style:{gap:"20px"},children:[k.filter(t=>t.status==="completed").slice(0,10).map(t=>e.jsxs(N.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},whileHover:{scale:1.02,background:"rgba(255,255,255,0.04)"},className:"glass-card",style:{padding:"20px",borderLeft:"4px solid #10b981",background:"rgba(255,255,255,0.02)",position:"relative",cursor:"default"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"15px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"white",fontWeight:"800",fontSize:"16px"},children:t.driver?.name||"Unknown Driver"}),e.jsxs("div",{style:{color:"var(--text-muted)",fontSize:"12px"},children:[t.punchIn?.time?new Date(t.punchIn.time).toLocaleDateString():"N/A"," • ",t.punchIn?.time?new Date(t.punchIn.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"--:--"]})]}),e.jsxs("div",{style:{background:"rgba(16, 185, 129, 0.1)",color:"#10b981",padding:"6px 14px",borderRadius:"30px",fontSize:"13px",fontWeight:"900",height:"fit-content",border:"1px solid rgba(16, 185, 129, 0.1)"},children:["₹",t.dailyWage||0]})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.03)",borderRadius:"14px",padding:"15px",marginBottom:"15px",border:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"10px"},children:[e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",background:"#10b981",boxShadow:"0 0 8px #10b981"}}),e.jsx("div",{style:{fontSize:"13px",color:"white",fontWeight:"700"},children:t.pickUpLocation||"Airport T1"})]}),e.jsx("div",{style:{width:"1px",height:"20px",background:"rgba(255,255,255,0.1)",marginLeft:"4.5px",marginBottom:"10px"}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",border:"2px solid #f43f5e",boxShadow:"0 0 8px rgba(244, 63, 94, 0.4)"}}),e.jsx("div",{style:{fontSize:"13px",color:"white",fontWeight:"700"},children:t.dropLocation||"City Center"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:"10px",borderTop:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"10px",fontWeight:"800",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Vehicle"}),e.jsx("div",{style:{color:"var(--primary)",fontWeight:"900",fontSize:"14px"},children:t.vehicle?.carNumber?.split("#")[0]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"10px",fontWeight:"800",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Total KM"}),e.jsxs("div",{style:{color:"white",fontWeight:"800",fontSize:"14px"},children:[t.totalKM||t.punchOut?.km-t.punchIn?.km||0," KM"]})]})]}),t.punchOut?.review&&e.jsxs("div",{title:t.punchOut.review,style:{color:"#10b981",fontSize:"11px",fontStyle:"italic",maxWidth:"140px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",opacity:.7},children:['"',t.punchOut.review,'"']})]})]},t._id)),k.filter(t=>t.status==="completed").length===0&&e.jsx("div",{style:{gridColumn:"1/-1",textAlign:"center",padding:"60px",color:"var(--text-muted)",background:"rgba(255,255,255,0.01)",borderRadius:"24px",border:"2px dashed rgba(255,255,255,0.05)"},children:"No completed duties logged yet."})]})]}),e.jsxs(We,{children:[re&&e.jsx(R,{title:"Add New Freelancer",onClose:()=>P(!1),children:e.jsxs("form",{onSubmit:he,style:{display:"grid",gap:"20px"},children:[e.jsx(o,{label:"Full Name *",value:f.name,onChange:t=>A({...f,name:t}),required:!0}),e.jsxs("div",{className:"freelancer-modal-grid",children:[e.jsx(o,{label:"Mobile Number *",value:f.mobile,onChange:t=>A({...f,mobile:t}),required:!0}),e.jsx(o,{label:"License Number",value:f.licenseNumber,onChange:t=>A({...f,licenseNumber:t})})]}),e.jsx(F,{disabled:B,text:"Register Freelancer",message:G})]})}),ne&&e.jsx(R,{title:`Edit Freelancer: ${Y?.name}`,onClose:()=>E(!1),children:e.jsxs("form",{onSubmit:fe,style:{display:"grid",gap:"20px"},children:[e.jsx(o,{label:"Full Name *",value:y.name,onChange:t=>O({...y,name:t}),required:!0}),e.jsxs("div",{className:"form-grid-2",children:[e.jsx(o,{label:"Mobile Number *",value:y.mobile,onChange:t=>O({...y,mobile:t}),required:!0}),e.jsx(o,{label:"License Number",value:y.licenseNumber,onChange:t=>O({...y,licenseNumber:t})})]}),e.jsx(F,{disabled:B,text:"Update Freelancer",message:G})]})}),ae&&e.jsx(R,{title:`Assign Duty: ${v?.name}`,onClose:()=>I(!1),children:e.jsxs("form",{onSubmit:ue,style:{display:"grid",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Select Vehicle *"}),e.jsx("input",{type:"text",list:"vehicle-list",className:"input-field",placeholder:"Type car number to find...",required:!0,autoComplete:"off",value:ge,onChange:t=>{q(t.target.value);const i=z.find(l=>l.carNumber?.split("#")[0]?.toUpperCase()===t.target.value.toUpperCase());h(i?{...c,vehicleId:i._id}:{...c,vehicleId:""})},style:{height:"45px"}}),e.jsx("datalist",{id:"vehicle-list",children:z.filter(t=>!t.currentDriver).map(t=>e.jsx("option",{value:t.carNumber?.split("#")[0],children:t.model},t._id))})]}),e.jsxs("div",{className:"form-grid-2",children:[e.jsx(o,{label:"Duty Date *",type:"date",value:c.date,onChange:t=>h({...c,date:t}),required:!0}),e.jsx(o,{label:"Punch-In Time *",type:"datetime-local",value:c.time,onChange:t=>h({...c,time:t}),required:!0})]}),e.jsxs("div",{className:"form-grid-2",children:[e.jsx(o,{label:"Starting KM *",type:"number",value:c.km,onChange:t=>h({...c,km:t}),required:!0,autoComplete:"off"}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Pick-up Location"}),e.jsx("input",{type:"text",list:"pickup-list",className:"input-field",placeholder:"Type or select...",autoComplete:"off",value:c.pickUpLocation,onChange:t=>h({...c,pickUpLocation:t.target.value})}),e.jsx("datalist",{id:"pickup-list",children:ve.map(t=>e.jsx("option",{value:t},t))})]})]}),e.jsx(F,{disabled:B,text:"Start Duty"})]})}),se&&e.jsx(R,{title:`Duty Completion: ${v?.name}`,onClose:()=>C(!1),children:e.jsxs("form",{onSubmit:me,style:{display:"grid",gap:"20px"},children:[e.jsxs("div",{className:"form-grid-2",children:[e.jsx(o,{label:"Closing KM *",type:"number",value:n.km,onChange:t=>p({...n,km:t}),required:!0}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Drop Location"}),e.jsx("input",{type:"text",list:"drop-list",className:"input-field",placeholder:"Type or select...",value:n.dropLocation,onChange:t=>p({...n,dropLocation:t.target.value})}),e.jsx("datalist",{id:"drop-list",children:je.map(t=>e.jsx("option",{value:t},t))})]})]}),e.jsxs("div",{className:"form-grid-2",children:[e.jsx(o,{label:"Punch-Out Time *",type:"datetime-local",value:n.time,onChange:t=>p({...n,time:t}),required:!0}),e.jsxs("div",{style:{opacity:.5},children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Duty Date Range"}),e.jsxs("p",{style:{fontSize:"12px",color:"white",margin:0,paddingTop:"10px"},children:["Started: ",v?.activeAttendance?.punchIn?.time?new Date(v.activeAttendance.punchIn.time).toLocaleString():"N/A"]})]})]}),e.jsxs("div",{className:"form-grid-2",children:[e.jsx(o,{label:"Fuel Spent (₹)",type:"number",value:n.fuelAmount,onChange:t=>p({...n,fuelAmount:t})}),e.jsx(o,{label:"Parking/Toll (₹)",type:"number",value:n.parkingAmount,onChange:t=>p({...n,parkingAmount:t})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"12px",display:"block"},children:"Duty Salary (Wage) *"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(60px, 1fr))",gap:"10px"},children:[[300,400,500].map(t=>e.jsxs("button",{type:"button",onClick:()=>p({...n,dailyWage:t}),style:{padding:"10px",borderRadius:"10px",border:"1px solid "+(n.dailyWage===t?"var(--primary)":"rgba(255,255,255,0.1)"),background:n.dailyWage===t?"rgba(14, 165, 233, 0.1)":"transparent",color:"white",fontWeight:"800"},children:["₹",t]},t)),e.jsx("input",{type:"number",placeholder:"Other",className:"input-field",style:{marginBottom:0,padding:"10px",height:"auto",textAlign:"center"},value:[300,400,500].includes(n.dailyWage)?"":n.dailyWage,onChange:t=>p({...n,dailyWage:Number(t.target.value)})})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Review / Remarks"}),e.jsx("textarea",{className:"input-field",style:{height:"80px",paddingTop:"12px"},placeholder:"",value:n.review,onChange:t=>p({...n,review:t.target.value})})]}),e.jsx(F,{disabled:B,text:"Finish Duty & Release Vehicle"})]})})]})]})},R=({title:a,onClose:x,children:d})=>e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",zIndex:1e3,display:"flex",justifyContent:"center",alignItems:"center",padding:"15px"},children:e.jsxs(N.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"glass-card modal-content",style:{width:"100%",maxWidth:"550px",padding:"25px",maxHeight:"95vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"25px"},children:[e.jsx("h2",{style:{color:"white",fontSize:"20px",margin:0,fontWeight:"800"},children:a}),e.jsx("button",{onClick:x,style:{background:"rgba(255,255,255,0.05)",color:"white",padding:"8px",borderRadius:"50%"},children:e.jsx(De,{size:20})})]}),d]})}),o=({label:a,value:x,onChange:d,type:z="text",required:_=!1,autoComplete:W="off",placeholder:D=""})=>e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:a}),e.jsx("input",{type:z,className:"input-field",required:_,value:x,onChange:b=>d(b.target.value),autoComplete:W,placeholder:D})]}),F=({disabled:a,text:x,message:d})=>e.jsxs("div",{style:{marginTop:"10px"},children:[d?.text&&e.jsxs("div",{style:{padding:"12px",borderRadius:"12px",fontSize:"14px",marginBottom:"15px",display:"flex",alignItems:"center",gap:"10px",background:d.type==="success"?"rgba(16, 185, 129, 0.1)":"rgba(244, 63, 94, 0.1)",color:d.type==="success"?"#10b981":"#f43f5e",border:`1px solid ${d.type==="success"?"rgba(16, 185, 129, 0.1)":"rgba(244, 63, 94, 0.1)"}`},children:[d.type==="success"?e.jsx(Ie,{size:18}):e.jsx(Ce,{size:18}),d.text]}),e.jsx("button",{type:"submit",disabled:a,className:"btn-primary",style:{width:"100%",padding:"15px",fontWeight:"800",textTransform:"uppercase"},children:a?"Processing...":x})]});export{_e as default};
