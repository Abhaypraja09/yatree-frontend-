import{b as a,j as e,ad as pe,O as Y,K as ce,Q as A,p as V,_ as G,m as u,a4 as O,I as xe,aa as X,M as ge,C as he,af as ue,H as K,A as fe,X as B,x as Z,ag as Q,R as I}from"./vendor-BXfTzn-0.js";import{b as be,i as f}from"./index-C6MgHkp-.js";import{u as _,w as ye}from"./excel-CRHyTskB.js";import{S as me}from"./SEO-Dbf0-trz.js";const je=({onCapture:o,onClose:b})=>{const y=I.useRef(null),C=I.useRef(null),p=I.useRef(null),[v,S]=I.useState(null);I.useEffect(()=>(N(),()=>z()),[]);const N=async()=>{try{const l={video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}},n=await navigator.mediaDevices.getUserMedia(l);p.current=n,y.current&&(y.current.srcObject=n)}catch(l){console.error("Camera error:",l),S("Could not access camera. Please ensure permissions are granted.")}},z=()=>{p.current&&(p.current.getTracks().forEach(l=>l.stop()),p.current=null)},R=()=>{const l=y.current,n=C.current;l&&n&&(n.width=l.videoWidth,n.height=l.videoHeight,n.getContext("2d").drawImage(l,0,0,n.width,n.height),n.toBlob(D=>{const m=new File([D],"parking.jpg",{type:"image/jpeg"});o(m,n.toDataURL("image/jpeg")),z(),b()},"image/jpeg",.8))};return e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.9)",zIndex:1100,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px"},children:e.jsxs("div",{className:"glass-card",style:{width:"100%",maxWidth:"500px",padding:"20px",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[e.jsx("h3",{style:{color:"white",margin:0},children:"Capture Parking Photo"}),e.jsx("button",{onClick:b,style:{background:"none",border:"none",color:"white",cursor:"pointer"},children:e.jsx(B,{size:24})})]}),v?e.jsx("div",{style:{color:"#f43f5e",padding:"20px",textAlign:"center"},children:v}):e.jsx("video",{ref:y,autoPlay:!0,playsInline:!0,style:{width:"100%",borderRadius:"12px",background:"black"}}),e.jsx("canvas",{ref:C,style:{display:"none"}}),!v&&e.jsxs("button",{onClick:R,style:{width:"100%",marginTop:"20px",padding:"15px",borderRadius:"12px",background:"var(--primary)",color:"white",border:"none",fontWeight:"800",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[e.jsx(Z,{size:20})," CAPTURE PHOTO"]})]})})},Ie=()=>{const{selectedCompany:o}=be(),b=t=>t?t.startsWith("http")?t:`${"".replace(/\/+$/,"")}/${t.replace(/^\/+/,"")}`:"",[y,C]=a.useState([]),[p,v]=a.useState([]),[S,N]=a.useState([]),[z,R]=a.useState(!0),[l,n]=a.useState(!1),[T,D]=a.useState(""),[m,ee]=a.useState("All"),[c,E]=a.useState({from:new Date(Date.now()-720*60*60*1e3).toISOString().split("T")[0],to:new Date().toISOString().split("T")[0]}),[d,x]=a.useState({driverId:"",driver:"",amount:"",date:new Date().toISOString().split("T")[0],receiptPhoto:""}),[w,M]=a.useState(!1),[te,j]=a.useState(!1),[F,W]=a.useState(""),[re,$]=a.useState(!1);a.useEffect(()=>{o&&(P(),L(),ie())},[o,c]);const L=async()=>{if(o?._id)try{const t=localStorage.getItem("userInfo"),r=t?JSON.parse(t):null;if(!r?.token)return;const{data:i}=await f.get(`/api/admin/parking/pending/${o._id}`,{headers:{Authorization:`Bearer ${r.token}`}});N(i||[])}catch(t){console.error(t)}},P=async()=>{if(o?._id){R(!0);try{const t=localStorage.getItem("userInfo"),r=t?JSON.parse(t):null;if(!r?.token)return;const{data:i}=await f.get(`/api/admin/parking/${o._id}?from=${c.from}&to=${c.to}`,{headers:{Authorization:`Bearer ${r.token}`}});C(i||[])}catch(t){console.error(t)}finally{R(!1)}}},ie=async()=>{if(o?._id)try{const t=localStorage.getItem("userInfo"),r=t?JSON.parse(t):null;if(!r?.token)return;const{data:i}=await f.get(`/api/admin/drivers/${o._id}?usePagination=false&isFreelancer=false`,{headers:{Authorization:`Bearer ${r.token}`}});v(i.drivers||[])}catch(t){console.error(t)}},se=async t=>{t.preventDefault(),M(!0);try{const r=localStorage.getItem("userInfo"),i=r?JSON.parse(r):null;if(!i?.token)return;await f.post("/api/admin/parking",{...d,companyId:o._id},{headers:{Authorization:`Bearer ${i.token}`}}),alert("Parking entry added successfully"),n(!1),q(),P()}catch(r){console.error(r),alert(r.response?.data?.message||"Error saving entry")}finally{M(!1)}},H=async t=>{if(window.confirm("Are you sure you want to delete this entry?"))try{const r=localStorage.getItem("userInfo"),i=r?JSON.parse(r):null;if(!i?.token)return;await f.delete(`/api/admin/parking/${t}`,{headers:{Authorization:`Bearer ${i.token}`}}),P()}catch(r){console.error(r)}},U=async(t,r,i)=>{try{const s=localStorage.getItem("userInfo"),h=s?JSON.parse(s):null;if(!h?.token)return;await f.patch(`/api/admin/attendance/${t}/expense/${r}`,{status:i},{headers:{Authorization:`Bearer ${h.token}`}}),L(),P()}catch(s){console.error(s),alert("Error processing request")}},ne=t=>{x({driverId:t.driverId?._id||"",driver:t.driver||"",amount:t.amount||"",date:new Date(t.date).toISOString().split("T")[0],receiptPhoto:t.receiptPhoto||""}),n(!0)},J=async t=>{const r=t.type==="change"?t.target.files[0]:t;if(!r)return;const i=new FormData;i.append("file",r),i.append("upload_preset","yatreedestination");try{const s=localStorage.getItem("userInfo"),h=s?JSON.parse(s):null,k=await f.post("/api/admin/upload",i,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${h?.token}`}});x({...d,receiptPhoto:k.data.url})}catch(s){console.error("Upload failed:",s),alert("Image upload failed. Please try again.")}},q=()=>{x({driverId:"",driver:"",amount:"",date:new Date().toISOString().split("T")[0],receiptPhoto:""})},ae=()=>{const t=g.map(s=>({Date:new Date(s.date).toLocaleDateString("en-IN"),Vehicle:s.vehicle?.carNumber||"N/A",Driver:s.driver||"N/A","Amount (₹)":s.amount,Source:s.source||"Admin"})),r=_.json_to_sheet(t),i=_.book_new();_.book_append_sheet(i,r,"Parking Logs"),ye(i,`Parking_Report_${o?.name}_${new Date().toISOString().split("T")[0]}.xlsx`)},g=y.filter(t=>{const r=t.vehicle?.carNumber||"",i=t.driver||"",s=r.toLowerCase().includes(T.toLowerCase())||i.toLowerCase().includes(T.toLowerCase());if(t.driverId?.isFreelancer||t.driver?.includes("(F)"))return!1;const k=m==="All"||t.driverId?._id===m||t.driver===m;return s&&k}),oe=g.reduce((t,r)=>t+(Number(r.amount)||0),0),le=g.filter(t=>t.source==="Driver").reduce((t,r)=>t+(Number(r.amount)||0),0),de=g.filter(t=>t.source==="Admin").reduce((t,r)=>t+(Number(r.amount)||0),0);return e.jsxs("div",{className:"container-fluid",style:{paddingBottom:"40px"},children:[e.jsx(me,{title:"Parking Management",description:"Track parking expenses, driver payments, and office costs."}),e.jsxs("header",{style:{padding:"clamp(20px, 4vw, 40px) 0"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"20px",marginBottom:"30px"},children:[e.jsxs("div",{style:{flex:"1 1 300px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#818cf8",boxShadow:"0 0 12px rgba(129, 140, 248, 0.5)"}}),e.jsx("span",{style:{fontSize:"10px",fontWeight:"800",color:"rgba(255,255,255,0.4)",letterSpacing:"2px",textTransform:"uppercase"},children:"Financial Records"})]}),e.jsxs("h1",{style:{color:"white",margin:0,letterSpacing:"-1px",fontSize:"clamp(28px, 5vw, 42px)",fontWeight:"900",lineHeight:1},children:["Parking ",e.jsx("span",{style:{background:"linear-gradient(to right, #818cf8, #c084fc)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Logs"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap",width:"auto",justifyContent:"flex-start"},children:[e.jsxs("button",{onClick:ae,style:{display:"flex",alignItems:"center",gap:"8px",height:"48px",padding:"0 20px",borderRadius:"12px",fontWeight:"700",background:"rgba(255,255,255,0.03)",color:"white",border:"1px solid rgba(255,255,255,0.1)",transition:"all 0.3s ease",cursor:"pointer",flex:"1 1 auto"},onMouseOver:t=>t.currentTarget.style.background="rgba(255,255,255,0.08)",onMouseOut:t=>t.currentTarget.style.background="rgba(255,255,255,0.03)",children:[e.jsx(pe,{size:18})," ",e.jsx("span",{className:"hide-mobile",children:"Export Report"}),e.jsx("span",{className:"show-mobile",children:"Export"})]}),e.jsxs("button",{onClick:()=>{q(),n(!0)},style:{display:"flex",alignItems:"center",gap:"10px",height:"48px",padding:"0 24px",borderRadius:"12px",fontWeight:"800",background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",color:"white",border:"none",boxShadow:"0 8px 20px -6px rgba(99, 102, 241, 0.5)",transition:"all 0.3s ease",cursor:"pointer",flex:"1 1 auto",justifyContent:"center"},onMouseOver:t=>t.currentTarget.style.transform="translateY(-2px)",onMouseOut:t=>t.currentTarget.style.transform="translateY(0)",children:[e.jsx(Y,{size:20})," ",e.jsx("span",{children:"New Entry"})]})]})]}),e.jsx("div",{className:"glass-card",style:{padding:"12px",borderRadius:"16px",background:"rgba(15, 23, 42, 0.4)",border:"1px solid rgba(255,255,255,0.05)",display:"flex",flexDirection:"column",gap:"12px"},children:e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"12px",width:"100%"},children:[e.jsxs("div",{style:{position:"relative",flex:"1 1 300px"},children:[e.jsx(ce,{size:18,style:{position:"absolute",left:"15px",top:"15px",color:"rgba(255,255,255,0.3)"}}),e.jsx("input",{type:"text",placeholder:"Search vehicle, driver or location...",value:T,onChange:t=>D(t.target.value),style:{height:"48px",width:"100%",background:"rgba(0,0,0,0.2)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:"12px",padding:"0 15px 0 45px",color:"white",fontSize:"14px",outline:"none",transition:"all 0.3s ease"}})]}),e.jsxs("div",{className:"glass-card",style:{padding:"0 15px",display:"flex",alignItems:"center",height:"48px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.08)",flex:"1 1 200px",background:"rgba(0,0,0,0.2)"},children:[e.jsx(A,{size:18,style:{marginRight:"10px",color:"var(--primary)"}}),e.jsxs("select",{value:m,onChange:t=>ee(t.target.value),style:{background:"transparent",border:"none",color:"white",outline:"none",fontSize:"14px",fontWeight:"700",cursor:"pointer",width:"100%"},children:[e.jsx("option",{value:"All",style:{background:"#1e293b"},children:"All Drivers"}),p.map(t=>e.jsx("option",{value:t._id,style:{background:"#1e293b"},children:t.name},t._id))]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",flex:"1 1 300px",minWidth:"0"},className:"mobile-stack",children:[e.jsxs("div",{style:{position:"relative",flex:1,minWidth:"120px"},children:[e.jsx(V,{size:14,style:{position:"absolute",left:"12px",top:"17px",color:"rgba(255,255,255,0.3)"}}),e.jsx("input",{type:"date",className:"input-field",style:{height:"48px",padding:"0 12px 0 35px",background:"rgba(0,0,0,0.2)",border:"1px solid rgba(255,255,255,0.08)",width:"100%",borderRadius:"12px",fontSize:"13px",colorScheme:"dark"},value:c.from,onChange:t=>E({...c,from:t.target.value})})]}),e.jsxs("div",{style:{position:"relative",flex:1,minWidth:"120px"},children:[e.jsx(V,{size:14,style:{position:"absolute",left:"12px",top:"17px",color:"rgba(255,255,255,0.3)"}}),e.jsx("input",{type:"date",className:"input-field",style:{height:"48px",padding:"0 12px 0 35px",background:"rgba(0,0,0,0.2)",border:"1px solid rgba(255,255,255,0.08)",width:"100%",borderRadius:"12px",fontSize:"13px",colorScheme:"dark"},value:c.to,onChange:t=>E({...c,to:t.target.value})})]})]})]})})]}),S.length>0&&e.jsxs("div",{style:{marginBottom:"40px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"20px"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"12px",background:"rgba(244, 63, 94, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",color:"#f43f5e"},children:e.jsx(G,{size:20})}),e.jsxs("div",{children:[e.jsx("h3",{style:{color:"white",fontSize:"18px",fontWeight:"800",margin:0},children:"Review Requests"}),e.jsxs("p",{style:{color:"rgba(244, 63, 94, 0.6)",fontSize:"11px",fontWeight:"700",textTransform:"uppercase",margin:0},children:[S.length," Pending Approvals"]})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:"20px"},children:S.map(t=>{const r=t.type==="other"?t.fuelType||"Other Service":"Parking",i=t.type==="other",s=i?"#f59e0b":"#818cf8",h=i?"rgba(245,158,11,0.1)":"rgba(129,140,248,0.1)",k=i?"rgba(245,158,11,0.25)":"rgba(129,140,248,0.25)";return e.jsxs(u.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"glass-card",style:{padding:"24px",border:"1px solid rgba(244, 63, 94, 0.2)",background:"linear-gradient(145deg, rgba(244, 63, 94, 0.05), rgba(15, 23, 42, 0.4))",borderRadius:"20px"},children:[e.jsxs("div",{style:{display:"flex",gap:"16px",marginBottom:"20px"},children:[t.slipPhoto?e.jsxs("div",{style:{position:"relative"},children:[e.jsx("img",{src:b(t.slipPhoto),onClick:()=>{W(t.slipPhoto),j(!0)},style:{width:"64px",height:"64px",borderRadius:"12px",objectFit:"cover",cursor:"pointer",border:"1px solid rgba(255,255,255,0.1)"}}),e.jsx("div",{style:{position:"absolute",bottom:"-8px",right:"-8px",background:"#f43f5e",color:"white",padding:"2px 6px",borderRadius:"6px",fontSize:"10px",fontWeight:"900"},children:"SLIP"})]}):e.jsx("div",{onClick:()=>{W(""),j(!0)},style:{width:"64px",height:"64px",borderRadius:"12px",background:"rgba(255,255,255,0.05)",display:"flex",justifyContent:"center",alignItems:"center",border:"1px dashed rgba(255,255,255,0.1)",cursor:"pointer"},children:e.jsx(O,{size:24,color:"rgba(255,255,255,0.2)"})}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"6px"},children:[e.jsxs("h4",{style:{color:"white",fontWeight:"900",fontSize:"22px",margin:0},children:["₹",t.amount]}),e.jsx("span",{style:{background:"rgba(244, 63, 94, 0.1)",color:"#f43f5e",fontSize:"9px",padding:"3px 8px",borderRadius:"6px",fontWeight:"800",textTransform:"uppercase",border:"1px solid rgba(244, 63, 94, 0.2)"},children:"Action Required"})]}),e.jsx("span",{style:{display:"inline-block",background:h,color:s,fontSize:"10px",padding:"2px 10px",borderRadius:"6px",fontWeight:"800",border:`1px solid ${k}`,marginTop:"6px",marginBottom:"2px",textTransform:"uppercase",letterSpacing:"0.5px"},children:r}),e.jsx("p",{style:{color:"white",fontSize:"13px",fontWeight:"700",margin:"4px 0 0"},children:t.driver}),e.jsx("p",{style:{color:"rgba(255,255,255,0.4)",fontSize:"11px",margin:"0"},children:t.carNumber})]})]}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{onClick:()=>U(t.attendanceId,t._id,"approved"),style:{flex:1.5,background:"#10b981",color:"white",border:"none",padding:"12px",borderRadius:"12px",fontWeight:"800",fontSize:"14px",cursor:"pointer",boxShadow:"0 4px 12px rgba(16, 185, 129, 0.2)"},children:"Approve"}),e.jsx("button",{onClick:()=>U(t.attendanceId,t._id,"rejected"),style:{flex:1,background:"rgba(255,255,255,0.03)",color:"rgba(255,255,255,0.6)",border:"1px solid rgba(255,255,255,0.1)",padding:"12px",borderRadius:"12px",fontWeight:"700",fontSize:"14px",cursor:"pointer"},children:"Reject"})]})]},t._id)})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(min(100%, 260px), 1fr))",gap:"20px",marginBottom:"40px"},children:[e.jsxs(u.div,{whileHover:{y:-5},className:"glass-card",style:{padding:"24px",background:"linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(30, 41, 59, 0.4) 100%)",border:"1px solid rgba(99, 102, 241, 0.2)",borderRadius:"20px",display:"flex",alignItems:"center",gap:"20px"},children:[e.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"16px",background:"rgba(99, 102, 241, 0.15)",display:"flex",alignItems:"center",justifyContent:"center",color:"#818cf8",border:"1px solid rgba(99, 102, 241, 0.2)"},children:e.jsx(xe,{size:28})}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"rgba(255,255,255,0.5)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"4px",letterSpacing:"1px"},children:"Total Expense"}),e.jsxs("h2",{style:{color:"white",fontSize:"28px",fontWeight:"900",margin:0},children:["₹",oe.toLocaleString()]})]})]}),e.jsxs(u.div,{whileHover:{y:-5},className:"glass-card",style:{padding:"24px",background:"linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(30, 41, 59, 0.4) 100%)",border:"1px solid rgba(16, 185, 129, 0.2)",borderRadius:"20px",display:"flex",alignItems:"center",gap:"20px"},children:[e.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"16px",background:"rgba(16, 185, 129, 0.15)",display:"flex",alignItems:"center",justifyContent:"center",color:"#34d399",border:"1px solid rgba(16, 185, 129, 0.2)"},children:e.jsx(X,{size:28})}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"rgba(255,255,255,0.5)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"4px",letterSpacing:"1px"},children:"From Driver Apps"}),e.jsxs("h2",{style:{color:"white",fontSize:"28px",fontWeight:"900",margin:0},children:["₹",le.toLocaleString()]})]})]}),e.jsxs(u.div,{whileHover:{y:-5},className:"glass-card",style:{padding:"24px",background:"linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(30, 41, 59, 0.4) 100%)",border:"1px solid rgba(245, 158, 11, 0.2)",borderRadius:"20px",display:"flex",alignItems:"center",gap:"20px"},children:[e.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"16px",background:"rgba(245, 158, 11, 0.15)",display:"flex",alignItems:"center",justifyContent:"center",color:"#fbbf24",border:"1px solid rgba(245, 158, 11, 0.2)"},children:e.jsx(G,{size:28})}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"rgba(255,255,255,0.5)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"4px",letterSpacing:"1px"},children:"Office Manual"}),e.jsxs("h2",{style:{color:"white",fontSize:"28px",fontWeight:"900",margin:0},children:["₹",de.toLocaleString()]})]})]})]}),e.jsx("div",{className:"glass-card",style:{padding:"0",overflow:"hidden",border:"1px solid rgba(255,255,255,0.05)"},children:z?e.jsx("div",{style:{padding:"100px",textAlign:"center"},children:e.jsx("div",{className:"spinner",style:{margin:"0 auto"}})}):g.length===0?e.jsxs("div",{style:{padding:"100px",textAlign:"center"},children:[e.jsx(ge,{size:48,style:{color:"rgba(255,255,255,0.1)",marginBottom:"20px"}}),e.jsx("h3",{style:{color:"white",opacity:.6},children:"No parking records found"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hide-mobile",style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:"0"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{textAlign:"left",background:"rgba(255,255,255,0.02)"},children:[e.jsx("th",{style:{padding:"20px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",letterSpacing:"1px"},children:"Date"}),e.jsx("th",{style:{padding:"20px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",letterSpacing:"1px"},children:"Driver"}),e.jsx("th",{style:{padding:"20px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",letterSpacing:"1px"},children:"Amount"}),e.jsx("th",{style:{padding:"20px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",letterSpacing:"1px"},children:"Source"}),e.jsx("th",{style:{padding:"20px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",textAlign:"right",letterSpacing:"1px"},children:"Actions"})]})}),e.jsx("tbody",{children:g.map(t=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.03)",transition:"all 0.2s ease"},className:"hover-row",children:[e.jsx("td",{style:{padding:"18px 25px"},children:e.jsx("div",{style:{color:"white",fontWeight:"700",fontSize:"14px"},children:new Date(t.date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"rgba(255,255,255,0.05)",display:"flex",alignItems:"center",justifyContent:"center",color:"rgba(255,255,255,0.5)"},children:e.jsx(A,{size:16})}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"white",fontWeight:"600"},children:t.driver}),t.vehicle&&e.jsxs("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.4)",marginTop:"2px",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(he,{size:10})," ",t.vehicle.carNumber]})]})]})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsxs("div",{style:{color:"#34d399",fontWeight:"800",fontSize:"16px"},children:["₹",t.amount]})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsx("span",{style:{fontSize:"9px",padding:"4px 10px",borderRadius:"20px",background:t.source==="Admin"?"rgba(245,158,11,0.1)":"rgba(99,102,241,0.1)",color:t.source==="Admin"?"#fbbf24":"#818cf8",fontWeight:"800",border:`1px solid ${t.source==="Admin"?"rgba(245,158,11,0.2)":"rgba(99,102,241,0.2)"}`,textTransform:"uppercase",letterSpacing:"0.5px"},children:t.source})}),e.jsx("td",{style:{padding:"18px 25px",textAlign:"right"},children:e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>{W(t.receiptPhoto||""),j(!0)},style:{width:"36px",height:"36px",borderRadius:"10px",background:t.receiptPhoto?"rgba(16, 185, 129, 0.1)":"rgba(244, 63, 94, 0.05)",color:t.receiptPhoto?"#10b981":"#f43f5e",border:"1px solid rgba(16, 185, 129, 0.2)",cursor:"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",opacity:t.receiptPhoto?1:.6},title:t.receiptPhoto?"View Photo":"Photo Missing",children:e.jsx(O,{size:16,style:{opacity:t.receiptPhoto?1:.5}})}),e.jsx("button",{onClick:()=>ne(t),style:{width:"36px",height:"36px",borderRadius:"10px",background:"rgba(99, 102, 241, 0.1)",color:"#818cf8",border:"1px solid rgba(99, 102, 241, 0.2)",cursor:"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},title:"Edit Entry",children:e.jsx(ue,{size:16})}),e.jsx("button",{onClick:()=>H(t._id),style:{width:"36px",height:"36px",borderRadius:"10px",background:"rgba(244,63,94,0.1)",color:"#f43f5e",border:"1px solid rgba(244,63,94,0.2)",cursor:"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},onMouseOver:r=>{r.currentTarget.style.background="#f43f5e",r.currentTarget.style.color="white"},onMouseOut:r=>{r.currentTarget.style.background="rgba(244,63,94,0.1)",r.currentTarget.style.color="#f43f5e"},children:e.jsx(K,{size:16})})]})})]},t._id))})]})}),e.jsx("div",{className:"show-mobile",style:{padding:"15px",display:"flex",flexDirection:"column",gap:"15px"},children:g.map(t=>e.jsxs(u.div,{initial:{opacity:0,y:10},whileInView:{opacity:1,y:0},viewport:{once:!0},style:{background:"rgba(255,255,255,0.02)",borderRadius:"20px",padding:"20px",border:"1px solid rgba(255,255,255,0.05)",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"4px",height:"100%",background:t.source==="Admin"?"#fbbf24":"#818cf8",opacity:.6}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px"},children:[e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"12px",background:"rgba(255,255,255,0.05)",display:"flex",alignItems:"center",justifyContent:"center",color:"rgba(255,255,255,0.5)"},children:e.jsx(A,{size:20})}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"white",fontWeight:"800",fontSize:"16px",letterSpacing:"0.5px"},children:t.driver}),e.jsxs("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.4)",marginTop:"2px",fontWeight:"700",display:"flex",alignItems:"center",gap:"5px"},children:[new Date(t.date).toLocaleDateString("en-IN",{day:"2-digit",month:"short"}),t.vehicle&&e.jsxs("span",{style:{opacity:.6},children:["• ",t.vehicle.carNumber]})]})]})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsxs("div",{style:{color:"#34d399",fontWeight:"900",fontSize:"20px"},children:["₹",t.amount]}),e.jsx("span",{style:{fontSize:"8px",padding:"2px 8px",borderRadius:"10px",background:"rgba(255,255,255,0.05)",color:"rgba(255,255,255,0.5)",fontWeight:"900",textTransform:"uppercase",border:"1px solid rgba(255,255,255,0.1)"},children:t.source})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"12px",marginBottom:"16px",padding:"12px",background:"rgba(0,0,0,0.2)",borderRadius:"14px",border:"1px solid rgba(255,255,255,0.03)"},children:e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"9px",color:"rgba(255,255,255,0.3)",textTransform:"uppercase",fontWeight:"800",marginBottom:"2px"},children:"Location"}),e.jsx("div",{style:{color:"white",fontSize:"13px",fontWeight:"700"},children:t.location||"Not Specified"})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{color:"rgba(255,255,255,0.4)",fontSize:"11px",fontStyle:"italic",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(X,{size:12})," ",t.remark||"No additional remarks"]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.receiptPhoto&&e.jsx("button",{onClick:()=>{W(t.receiptPhoto),j(!0)},style:{width:"32px",height:"32px",borderRadius:"8px",background:"rgba(16, 185, 129, 0.1)",color:"#10b981",border:"1px solid rgba(16, 185, 129, 0.2)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(O,{size:14})}),e.jsx("button",{onClick:()=>H(t._id),style:{width:"32px",height:"32px",borderRadius:"8px",background:"rgba(244,63,94,0.1)",color:"#f43f5e",border:"1px solid rgba(244,63,94,0.2)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(K,{size:14})})]})]})]},t._id))})]})}),e.jsxs(fe,{children:[l&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2, 6, 23, 0.85)",backdropFilter:"blur(12px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,padding:"20px"},children:e.jsxs(u.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"glass-card",style:{padding:"clamp(24px, 5vw, 40px)",width:"100%",maxWidth:"500px",background:"linear-gradient(145deg, #0f172a, #1e293b)",border:"1px solid rgba(255,255,255,0.1)",overflowY:"auto",maxHeight:"90vh",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{color:"white",fontSize:"24px",fontWeight:"900",margin:0,letterSpacing:"-0.5px"},children:"Manual Entry"}),e.jsx("p",{style:{color:"rgba(255,255,255,0.4)",fontSize:"11px",fontWeight:"700",textTransform:"uppercase",margin:"4px 0 0",letterSpacing:"1px"},children:"Add parking record"})]}),e.jsx("button",{onClick:()=>n(!1),style:{background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"white",width:"36px",height:"36px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:t=>t.currentTarget.style.background="rgba(244, 63, 94, 0.2)",onMouseOut:t=>t.currentTarget.style.background="rgba(255,255,255,0.05)",children:e.jsx(Y,{size:20,style:{transform:"rotate(45deg)"}})})]}),e.jsxs("form",{onSubmit:se,style:{display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsx("label",{style:{fontSize:"10px",fontWeight:"800",color:"rgba(255,255,255,0.4)",textTransform:"uppercase",letterSpacing:"1px"},children:"Select Driver"}),e.jsx("div",{style:{position:"relative"},children:e.jsxs("select",{className:"input-field",style:{height:"52px",borderRadius:"14px",background:"rgba(0,0,0,0.2)",border:"1px solid rgba(255,255,255,0.08)",color:"white",padding:"0 15px",width:"100%",outline:"none"},value:d.driverId,onChange:t=>{const r=p.find(i=>i._id===t.target.value);x({...d,driverId:t.target.value,driver:r?r.name:""})},required:!0,children:[e.jsx("option",{value:"",style:{background:"#1e293b"},children:"Select Driver"}),p.map(t=>e.jsx("option",{value:t._id,style:{background:"#1e293b"},children:t.name},t._id))]})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"15px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsx("label",{style:{fontSize:"10px",fontWeight:"800",color:"rgba(255,255,255,0.4)",textTransform:"uppercase",letterSpacing:"1px"},children:"Amount (₹)"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("span",{style:{position:"absolute",left:"15px",top:"16px",color:"#34d399",fontWeight:"900"},children:"₹"}),e.jsx("input",{type:"number",placeholder:"0.00",className:"input-field",style:{height:"52px",borderRadius:"14px",background:"rgba(0,0,0,0.2)",border:"1px solid rgba(255,255,255,0.08)",color:"white",padding:"0 15px 0 32px",width:"100%",outline:"none"},value:d.amount,onChange:t=>x({...d,amount:t.target.value}),required:!0})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsx("label",{style:{fontSize:"10px",fontWeight:"800",color:"rgba(255,255,255,0.4)",textTransform:"uppercase",letterSpacing:"1px"},children:"Date"}),e.jsx("input",{type:"date",className:"input-field",style:{height:"52px",borderRadius:"14px",background:"rgba(0,0,0,0.2)",border:"1px solid rgba(255,255,255,0.08)",color:"white",padding:"0 15px",width:"100%",outline:"none",colorScheme:"dark"},value:d.date,onChange:t=>x({...d,date:t.target.value})})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsx("label",{style:{fontSize:"10px",fontWeight:"800",color:"rgba(255,255,255,0.4)",textTransform:"uppercase",letterSpacing:"1px"},children:"Parking Photo (Camera)"}),e.jsxs("div",{style:{display:"flex",gap:"15px",alignItems:"center"},children:[d.receiptPhoto?e.jsxs("div",{style:{position:"relative"},children:[e.jsx("img",{src:b(d.receiptPhoto),alt:"Receipt",style:{width:"80px",height:"80px",borderRadius:"12px",objectFit:"cover"}}),e.jsx("button",{type:"button",onClick:()=>x({...d,receiptPhoto:""}),style:{position:"absolute",top:"-8px",right:"-8px",background:"#f43f5e",color:"white",border:"none",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(B,{size:14})})]}):e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsxs("button",{type:"button",onClick:()=>$(!0),style:{width:"80px",height:"80px",borderRadius:"120px",background:"linear-gradient(135deg, #6366f1, #4f46e5)",border:"none",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",cursor:"pointer",transition:"all 0.3s ease",color:"white",boxShadow:"0 8px 15px rgba(99, 102, 241, 0.3)"},children:[e.jsx(Z,{size:24}),e.jsx("span",{style:{fontSize:"10px",marginTop:"4px",fontWeight:"900"},children:"Camera"})]}),e.jsxs("label",{style:{width:"80px",height:"80px",borderRadius:"20px",background:"rgba(255,255,255,0.05)",border:"2px dashed rgba(255,255,255,0.1)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",cursor:"pointer",transition:"all 0.3s ease"},children:[e.jsx(Q,{size:20,color:"rgba(255,255,255,0.3)"}),e.jsx("span",{style:{fontSize:"10px",color:"rgba(255,255,255,0.3)",marginTop:"4px",fontWeight:"800"},children:"Gallery"}),e.jsx("input",{type:"file",hidden:!0,onChange:J,accept:"image/*"})]})]}),e.jsx("div",{style:{flex:1},children:e.jsxs("p",{style:{margin:0,fontSize:"12px",color:"rgba(255,255,255,0.4)",fontWeight:"500"},children:["Use ",e.jsx("b",{children:"Camera"})," for direct photo or ",e.jsx("b",{children:"Gallery"})," to upload a file."]})})]})]}),e.jsx("button",{type:"submit",disabled:w,style:{height:"56px",marginTop:"10px",background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",borderRadius:"16px",fontWeight:"800",fontSize:"16px",color:"white",border:"none",boxShadow:"0 12px 24px -8px rgba(99, 102, 241, 0.5)",cursor:w?"not-allowed":"pointer",transition:"all 0.3s ease"},onMouseOver:t=>!w&&(t.currentTarget.style.transform="translateY(-2px)"),onMouseOut:t=>!w&&(t.currentTarget.style.transform="translateY(0)"),children:w?"Saving...":"Save Record"})]})]})}),te&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2, 6, 23, 0.95)",backdropFilter:"blur(20px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:9999,padding:"20px"},onClick:()=>j(!1),children:e.jsxs(u.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},style:{position:"relative",maxWidth:"min(700px, 90vw)",width:"100%",display:"flex",justifyContent:"center"},onClick:t=>t.stopPropagation(),children:[F?e.jsx("img",{src:b(F),alt:"Parking Photo",style:{width:"100%",height:"auto",maxHeight:"85vh",objectFit:"contain",borderRadius:"16px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)"}}):e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"50px",borderRadius:"20px",textAlign:"center",width:"100%"},children:[e.jsx(Q,{size:48,style:{opacity:.2,marginBottom:"15px"}}),e.jsx("p",{style:{color:"white",fontWeight:"700"},children:"No receipt image available."}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"13px",marginTop:"10px"},children:"To fix this: Click the Edit (Pen) icon on the entry and upload the receipt manually."})]}),e.jsx("button",{onClick:()=>j(!1),style:{position:"absolute",top:"-15px",right:"-15px",background:"#f43f5e",color:"white",border:"none",width:"36px",height:"36px",borderRadius:"50%",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 5px 15px rgba(244, 63, 94, 0.4)",zIndex:100},children:e.jsx(B,{size:20})})]})}),re&&e.jsx(je,{onClose:()=>$(!1),onCapture:t=>J(t)})]})]})};export{Ie as default};
