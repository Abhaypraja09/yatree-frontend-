import{b as s,j as e,m as l,G as k,C as b,H as T,A as B,X as R,x as F,l as A}from"./vendor-C8trtwqP.js";import{b as E,i as j}from"./index-D8zUNbQD.js";import{S as L}from"./SEO-BhlPLf3F.js";const M=()=>{const{selectedCompany:n}=E(),[c,S]=s.useState([]),[v,g]=s.useState(!0),[d,C]=s.useState(""),[N,x]=s.useState(!1),[h,w]=s.useState(null),[i,o]=s.useState({amount:"",method:"",remarks:""}),[f,u]=s.useState(!1),[r,p]=s.useState({type:"",text:""});s.useEffect(()=>{n&&m()},[n]);const m=async()=>{if(n?._id){g(!0);try{const t=JSON.parse(localStorage.getItem("userInfo")),{data:a}=await j.get(`/api/admin/vehicles/${n._id}`,{headers:{Authorization:`Bearer ${t.token}`}});S(a.vehicles||[])}catch(t){console.error(t)}finally{g(!1)}}},z=async t=>{t.preventDefault(),u(!0),p({type:"",text:""});try{const a=JSON.parse(localStorage.getItem("userInfo"));await j.post(`/api/admin/vehicles/${h._id}/fastag-recharge`,i,{headers:{Authorization:`Bearer ${a.token}`}}),p({type:"success",text:"Top-up successful!"}),setTimeout(()=>{x(!1),o({amount:"",method:"",remarks:""}),p({type:"",text:""}),m()},1e3)}catch(a){p({type:"error",text:a.response?.data?.message||"Failed to recharge"})}finally{u(!1)}},y=c.filter(t=>t.carNumber?.toLowerCase().includes(d.toLowerCase())||t.fastagNumber?.toLowerCase().includes(d.toLowerCase())),I=c.reduce((t,a)=>t+(a.fastagBalance||0),0),W=c.filter(t=>(t.fastagBalance||0)<200).length;return e.jsxs("div",{className:"container-fluid",style:{paddingBottom:"60px"},children:[e.jsx(L,{title:"Fastag Wallet Control",description:"Control fleet operational costs with real-time Fastag tracking and instant recharges."}),e.jsxs("header",{style:{padding:"clamp(20px, 5vw, 40px) 0",borderBottom:"1px solid rgba(255,255,255,0.05)",marginBottom:"30px"},children:[e.jsxs("div",{className:"flex-resp",style:{justifyContent:"space-between",alignItems:"flex-start",gap:"25px"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"8px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"var(--primary)",boxShadow:"0 0 10px var(--primary)"}}),e.jsx("span",{style:{fontSize:"11px",fontWeight:"900",color:"rgba(255,255,255,0.4)",letterSpacing:"2px",textTransform:"uppercase"},children:"Financial assets"})]}),e.jsxs("h1",{className:"resp-title",style:{margin:0,fontWeight:"900",letterSpacing:"-1.5px"},children:["Fastag ",e.jsx("span",{style:{color:"var(--primary)"},children:"Wallets"})]}),e.jsxs("p",{className:"resp-subtitle",style:{marginTop:"8px",maxWidth:"500px"},children:["Manage virtual balances for ",e.jsx("b",{children:n?.name})," fleet vehicles."]})]}),e.jsxs("div",{className:"flex-resp",style:{gap:"15px"},children:[e.jsxs(l.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"glass-card",style:{padding:"15px 25px",background:"rgba(16, 185, 129, 0.05)",border:"1px solid rgba(16, 185, 129, 0.1)",display:"flex",flexDirection:"column",minWidth:"140px"},children:[e.jsx("span",{style:{fontSize:"10px",fontWeight:"800",color:"#10b981",letterSpacing:"1px",textTransform:"uppercase"},children:"Fleet total"}),e.jsxs("span",{style:{color:"white",fontSize:"20px",fontWeight:"900",letterSpacing:"-0.5px"},children:["₹ ",I.toLocaleString()]})]}),e.jsxs(l.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"glass-card",style:{padding:"15px 25px",background:"rgba(244, 63, 94, 0.05)",border:"1px solid rgba(244, 63, 94, 0.1)",display:"flex",flexDirection:"column",minWidth:"140px"},children:[e.jsx("span",{style:{fontSize:"10px",fontWeight:"800",color:"#f43f5e",letterSpacing:"1px",textTransform:"uppercase"},children:"Critical Alert"}),e.jsxs("span",{style:{color:"white",fontSize:"20px",fontWeight:"900",letterSpacing:"-0.5px"},children:[W," LOW"]})]})]})]}),e.jsxs("div",{style:{position:"relative",maxWidth:"600px",margin:"30px 0 0"},children:[e.jsx(k,{size:20,style:{position:"absolute",left:"20px",top:"15px",color:"rgba(255,255,255,0.3)"}}),e.jsx("input",{type:"text",placeholder:"Search by car number or fastag identification...",value:d,onChange:t=>C(t.target.value),className:"input-field",style:{paddingLeft:"55px",width:"100%",marginBottom:0,height:"52px",borderRadius:"15px",background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.08)",fontSize:"14px"}})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px"},children:v?e.jsxs("div",{style:{gridColumn:"1/-1",textAlign:"center",padding:"100px 0"},children:[e.jsx("div",{className:"spinner",style:{margin:"0 auto 20px"}}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"14px",fontWeight:"600",letterSpacing:"1px"},children:"SYNCING ASSETS..."})]}):y.length===0?e.jsxs("div",{style:{gridColumn:"1/-1",textAlign:"center",padding:"120px 0",background:"rgba(30, 41, 59, 0.2)",borderRadius:"30px",border:"2px dashed rgba(255,255,255,0.05)"},children:[e.jsx(b,{size:60,style:{margin:"0 auto 20px",opacity:.1,color:"var(--primary)"}}),e.jsx("h3",{style:{color:"white",fontSize:"20px",fontWeight:"700",margin:0},children:"No Records Found"}),e.jsx("p",{style:{color:"var(--text-muted)",marginTop:"8px"},children:"Try searching with a different vehicle number."})]}):y.map((t,a)=>e.jsxs(l.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:a*.03},whileHover:{y:-5,transition:{duration:.2}},className:"glass-card",style:{padding:"25px",background:"linear-gradient(145deg, rgba(30, 41, 59, 0.7), rgba(15, 23, 42, 0.9))",border:"1px solid rgba(255,255,255,0.06)",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:"-20%",right:"-10%",width:"150px",height:"150px",background:(t.fastagBalance||0)<200?"rgba(244, 63, 94, 0.1)":"rgba(14, 165, 233, 0.1)",filter:"blur(50px)",pointerEvents:"none"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",position:"relative",zIndex:1},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"10px",color:"rgba(255,255,255,0.4)",fontWeight:"800",letterSpacing:"1px",textTransform:"uppercase"},children:"Registration No."}),e.jsx("h3",{style:{color:"white",margin:"2px 0 0",fontSize:"20px",fontWeight:"900",letterSpacing:"-0.5px"},children:t.carNumber})]}),e.jsx("div",{style:{width:"40px",height:"30px",background:"rgba(255,255,255,0.05)",borderRadius:"6px",border:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(b,{size:16,color:"rgba(255,255,255,0.3)"})})]}),e.jsxs("div",{style:{marginTop:"20px",position:"relative",zIndex:1},children:[e.jsx("span",{style:{fontSize:"10px",color:"rgba(255,255,255,0.4)",fontWeight:"800",letterSpacing:"1px",textTransform:"uppercase"},children:"FASTag ID / UPI"}),e.jsx("p",{style:{color:"white",margin:"2px 0 0",fontSize:"13px",fontWeight:"600"},children:t.fastagNumber||e.jsx("span",{style:{opacity:.3},children:"Not Linked"})})]}),e.jsxs("div",{style:{marginTop:"30px",display:"flex",justifyContent:"space-between",alignItems:"flex-end",position:"relative",zIndex:1},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"10px",color:"rgba(255,255,255,0.4)",fontWeight:"800",letterSpacing:"1px",textTransform:"uppercase"},children:"Virtual Credit"}),e.jsx("div",{style:{display:"flex",alignItems:"baseline",gap:"5px"},children:e.jsxs("span",{style:{color:(t.fastagBalance||0)<200?"#f43f5e":"#10b981",fontSize:"26px",fontWeight:"900"},children:["₹",t.fastagBalance?.toLocaleString()||0]})})]}),e.jsxs("button",{onClick:()=>{w(t),x(!0)},className:"glass-card-hover-effect",style:{background:(t.fastagBalance||0)<200?"rgba(244, 63, 94, 0.15)":"rgba(255,255,255,0.05)",color:(t.fastagBalance||0)<200?"#f43f5e":"white",border:`1px solid ${(t.fastagBalance||0)<200?"rgba(244, 63, 94, 0.3)":"rgba(255,255,255,0.1)"}`,padding:"8px 16px",borderRadius:"10px",fontSize:"12px",fontWeight:"800",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(T,{size:14})," RECHARGE"]})]}),e.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"4px",background:(t.fastagBalance||0)<200?"linear-gradient(90deg, #f43f5e, transparent)":"linear-gradient(90deg, #10b981, transparent)",opacity:.6}})]},t._id))}),e.jsx(B,{children:N&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(16px)",zIndex:1050,display:"flex",justifyContent:"center",alignItems:"center",padding:"15px"},children:e.jsxs(l.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},exit:{y:50,opacity:0},className:"glass-card",style:{width:"100%",maxWidth:"440px",padding:"30px",border:"1px solid rgba(255,255,255,0.1)",background:"linear-gradient(135deg, #1e293b 0%, #0f172a 100%)",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.5)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"25px"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{color:"white",fontSize:"22px",margin:0,fontWeight:"900",letterSpacing:"-0.5px"},children:"Wallet Top-up"}),e.jsxs("p",{style:{color:"var(--text-muted)",fontSize:"13px",marginTop:"4px"},children:["For vehicle ",e.jsx("b",{children:h?.carNumber})]})]}),e.jsx("button",{onClick:()=>x(!1),className:"glass-card-hover-effect",style:{color:"white",background:"rgba(255,255,255,0.05)",borderRadius:"10px",height:"32px",width:"32px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(R,{size:18})})]}),e.jsxs("form",{onSubmit:z,style:{display:"grid",gap:"20px"},children:[e.jsxs("div",{className:"input-field-group",children:[e.jsx("label",{className:"input-label",children:"Payment Amount (₹)"}),e.jsx("input",{type:"number",className:"input-field",placeholder:"0.00",required:!0,autoFocus:!0,value:i.amount,onChange:t=>o({...i,amount:t.target.value}),style:{height:"50px",fontSize:"20px",fontWeight:"800"}})]}),e.jsxs("div",{className:"input-field-group",children:[e.jsx("label",{className:"input-label",children:"Payment Method / Resource"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"Ex: HDFC Bank, GPay, UPI ID",value:i.method,onChange:t=>o({...i,method:t.target.value}),style:{height:"50px"}})]}),e.jsxs("div",{className:"input-field-group",children:[e.jsx("label",{className:"input-label",children:"Notes (Optional)"}),e.jsx("textarea",{className:"input-field",placeholder:"Add transaction reference...",rows:"2",value:i.remarks,onChange:t=>o({...i,remarks:t.target.value}),style:{resize:"none",paddingTop:"15px"}})]}),r.text&&e.jsxs(l.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},style:{padding:"12px",borderRadius:"10px",fontSize:"13px",fontWeight:"700",display:"flex",alignItems:"center",gap:"10px",background:r.type==="success"?"rgba(16, 185, 129, 0.1)":"rgba(244, 63, 94, 0.1)",color:r.type==="success"?"#10b981":"#f43f5e",border:`1px solid ${r.type==="success"?"rgba(16, 185, 129, 0.2)":"rgba(244, 63, 94, 0.2)"}`},children:[r.type==="success"?e.jsx(F,{size:16}):e.jsx(A,{size:16}),r.text]}),e.jsx("button",{type:"submit",disabled:f,className:"btn-primary",style:{height:"50px",fontSize:"15px",fontWeight:"900",letterSpacing:"1px",textTransform:"uppercase"},children:f?"PROCESSING...":"CONFIRM TOP-UP"})]})]})})})]})};export{M as default};
