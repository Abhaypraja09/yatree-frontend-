import{b as i,j as e,S as f,O as y,m as h,k as b,ab as J,E as U,p as q}from"./vendor-CCQY6jT8.js";import{b as G,i as p}from"./index-aG9LDhtf.js";import{S as W}from"./SEO-DDwZsfBo.js";const Y=()=>{const{selectedCompany:o}=G(),[A,E]=i.useState([]),[L,B]=i.useState([]),[l,j]=i.useState(null),[s,n]=i.useState({vehicleId:"",borderName:"",amount:"",date:new Date().toISOString().split("T")[0],remarks:"",driverId:""}),[v,S]=i.useState(null),[w,N]=i.useState(null),[z,_]=i.useState([]),[O,C]=i.useState(!1),[I,k]=i.useState(!1),[d,c]=i.useState({type:"",text:""}),[g,R]=i.useState(""),[m,P]=i.useState("");i.useEffect(()=>{o&&($(),u())},[o]);const $=async()=>{try{const t=JSON.parse(localStorage.getItem("userInfo")).token,r=await p.get(`/api/admin/vehicles/${o._id}`,{headers:{Authorization:`Bearer ${t}`}}),a=await p.get(`/api/admin/drivers/${o._id}`,{headers:{Authorization:`Bearer ${t}`}});E(r.data.vehicles||[]),B(a.data.drivers||[])}catch(t){console.error("Error fetching data",t)}},u=async()=>{C(!0);try{const t=JSON.parse(localStorage.getItem("userInfo")).token,{data:r}=await p.get(`/api/admin/border-tax/${o._id}`,{headers:{Authorization:`Bearer ${t}`}});_(r)}catch(t){console.error("Error fetching border tax entries",t)}finally{C(!1)}},V=t=>{const r=t.target.files[0];r&&(S(r),N(URL.createObjectURL(r)))},F=async t=>{t.preventDefault(),k(!0),c({type:"",text:""});try{const r=JSON.parse(localStorage.getItem("userInfo")).token,a=new FormData;Object.keys(s).forEach(D=>a.append(D,s[D])),a.append("companyId",o._id),v&&a.append("receiptPhoto",v),await p.post("/api/admin/border-tax",a,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"multipart/form-data"}}),c({type:"success",text:"Border Tax recorded successfully!"}),n({vehicleId:l?._id||"",borderName:"",amount:"",date:new Date().toISOString().split("T")[0],remarks:"",driverId:""}),S(null),N(null),u()}catch(r){c({type:"error",text:r.response?.data?.message||"Failed to record entry"})}finally{k(!1)}},M=async t=>{if(window.confirm("Are you sure you want to delete this entry?"))try{const r=JSON.parse(localStorage.getItem("userInfo")).token;await p.delete(`/api/admin/border-tax/${t}`,{headers:{Authorization:`Bearer ${r}`}}),c({type:"success",text:"Entry deleted successfully"}),u()}catch{c({type:"error",text:"Failed to delete entry"})}},T=A.filter(t=>t.carNumber.toLowerCase().includes(m.toLowerCase())||t.model?.toLowerCase().includes(m.toLowerCase())),x=z.filter(t=>{const r=t.borderName.toLowerCase().includes(g.toLowerCase())||t.vehicle?.carNumber.toLowerCase().includes(g.toLowerCase()),a=l?t.vehicle?._id===l._id:!0;return r&&a}),H=t=>{j(t),n(r=>({...r,vehicleId:t._id})),R("")};return l?e.jsxs("div",{className:"container-fluid",style:{paddingBottom:"40px"},children:[e.jsx(W,{title:`${l.carNumber} - Border Tax`,description:"Record and manage border tax entries for specific vehicles."}),e.jsxs("header",{style:{padding:"30px 0",gap:"20px"},className:"flex-resp",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",flex:1},children:[e.jsx("button",{onClick:()=>j(null),className:"glass-card-hover-effect",style:{background:"rgba(255,255,255,0.05)",color:"white",padding:"10px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.08)"},children:e.jsx(b,{size:20,style:{transform:"rotate(180deg)"},color:"#fbbf24"})}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[e.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:"#fbbf24",boxShadow:"0 0 8px #fbbf24"}}),e.jsx("span",{style:{fontSize:"10px",fontWeight:"900",color:"rgba(255,255,255,0.4)",letterSpacing:"1px",textTransform:"uppercase"},children:"Management Detail"})]}),e.jsxs("h1",{className:"resp-title",style:{color:"white",fontSize:"24px",fontWeight:"900",margin:0,cursor:"pointer"},children:[l.carNumber," ",e.jsx("span",{className:"text-gradient-yellow",children:"Permits"})]})]})]}),e.jsxs("div",{className:"flex-resp",style:{gap:"15px"},children:[e.jsxs("div",{className:"glass-card",style:{padding:"12px 20px",borderRadius:"14px",background:"rgba(16, 185, 129, 0.05)",border:"1px solid rgba(16, 185, 129, 0.1)",display:"flex",flexDirection:"column",minWidth:"130px",flex:1},children:[e.jsx("span",{style:{fontSize:"9px",fontWeight:"800",color:"#10b981",letterSpacing:"1px"},children:"TOTAL PAID"}),e.jsxs("span",{style:{color:"white",fontSize:"18px",fontWeight:"900"},children:["₹",x.reduce((t,r)=>t+(Number(r.amount)||0),0).toLocaleString()]})]}),e.jsxs("div",{className:"glass-card",style:{padding:"12px 20px",borderRadius:"14px",background:"rgba(14, 165, 233, 0.05)",border:"1px solid rgba(14, 165, 233, 0.1)",display:"flex",flexDirection:"column",minWidth:"130px",flex:1},children:[e.jsx("span",{style:{fontSize:"9px",fontWeight:"800",color:"var(--primary)",letterSpacing:"1px"},children:"RECORDS"}),e.jsxs("span",{style:{color:"white",fontSize:"18px",fontWeight:"900"},children:[x.length," entries"]})]})]})]}),e.jsxs("div",{className:"responsive-split-layout",style:{display:"grid",gap:"30px",alignItems:"start"},children:[e.jsx("style",{children:`
                    .responsive-split-layout { grid-template-columns: 1fr; }
                    @media (min-width: 1024px) { .responsive-split-layout { grid-template-columns: minmax(350px, 400px) 1fr; } }
                `}),e.jsxs(h.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"glass-card",style:{padding:"25px",border:"1px solid rgba(255,255,255,0.05)",background:"rgba(30, 41, 59, 0.4)"},children:[e.jsxs("h2",{style:{color:"white",fontSize:"16px",fontWeight:"800",marginBottom:"25px",display:"flex",alignItems:"center",gap:"10px",textTransform:"uppercase",letterSpacing:"1px"},children:[e.jsx(f,{size:18,color:"var(--primary)"}),"Add New entry"]}),e.jsxs("form",{onSubmit:F,style:{display:"grid",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Border Name *"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"Ex: Delhi-Agra Toll",required:!0,value:s.borderName,onChange:t=>n({...s,borderName:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Responsible Driver"}),e.jsxs("select",{className:"input-field",value:s.driverId,onChange:t=>n({...s,driverId:t.target.value}),style:{appearance:"auto"},children:[e.jsx("option",{value:"",children:"Select Driver"}),L.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))]})]}),e.jsx("style",{children:`
                            .bt-form-grid { display: grid; grid-template-columns: 1fr; gap: 15px; }
                            @media (min-width: 640px) { .bt-form-grid { grid-template-columns: 1fr 1fr; } }
                        `}),e.jsxs("div",{className:"bt-form-grid",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Amount (₹) *"}),e.jsx("input",{type:"number",className:"input-field",placeholder:"0.00",required:!0,value:s.amount,onChange:t=>n({...s,amount:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Entry Date"}),e.jsx("input",{type:"date",className:"input-field",required:!0,value:s.date,onChange:t=>n({...s,date:t.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Notes / Remarks"}),e.jsx("textarea",{className:"input-field",style:{height:"60px",paddingTop:"10px",resize:"none"},placeholder:"Additional details...",value:s.remarks,onChange:t=>n({...s,remarks:t.target.value})})]}),e.jsxs("div",{style:{marginTop:"5px"},children:[e.jsx("label",{className:"input-label",children:"Upload Receipt Copy"}),e.jsxs("label",{style:{display:"block",cursor:"pointer"},children:[e.jsx("input",{type:"file",accept:"image/*",onChange:V,style:{display:"none"}}),e.jsx("div",{style:{border:"2px dashed rgba(255,255,255,0.08)",borderRadius:"12px",padding:"15px",textAlign:"center",background:"rgba(255,255,255,0.01)",transition:"all 0.2s",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:w?e.jsx("img",{src:w,style:{height:"80px",borderRadius:"8px"}}):e.jsxs(e.Fragment,{children:[e.jsx(J,{size:20,color:"var(--primary)"}),e.jsx("span",{style:{color:"white",fontSize:"13px",fontWeight:"700"},children:"Choose Receipt Image"})]})})]})]}),d.text&&e.jsxs("div",{style:{padding:"10px 15px",borderRadius:"10px",fontSize:"13px",fontWeight:"700",background:d.type==="success"?"rgba(16, 185, 129, 0.1)":"rgba(244, 63, 94, 0.1)",color:d.type==="success"?"#10b981":"#f43f5e",display:"flex",alignItems:"center",gap:"8px"},children:[d.type==="success"?e.jsx(U,{size:14}):e.jsx(b,{size:14}),d.text]}),e.jsx("button",{type:"submit",disabled:I,className:"btn-primary",style:{width:"100%",height:"50px",fontSize:"14px",fontWeight:"800",textTransform:"uppercase",letterSpacing:"1px"},children:I?"PROCESSING...":"SAVE RECORD"})]})]}),e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},style:{display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsxs("div",{className:"glass-card flex-resp",style:{padding:"15px 20px",border:"1px solid rgba(255,255,255,0.05)",justifyContent:"space-between",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{color:"white",fontSize:"17px",fontWeight:"800",margin:0},children:"Recent Logs"}),e.jsxs("p",{style:{color:"var(--text-muted)",fontSize:"12px",margin:0},children:["History for ",l.carNumber]})]}),e.jsxs("div",{style:{position:"relative",maxWidth:"280px",flex:1,width:"100%"},children:[e.jsx(y,{size:16,style:{position:"absolute",left:"12px",top:"13px",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search history...",className:"input-field",value:g,onChange:t=>R(t.target.value),style:{paddingLeft:"38px",height:"42px",fontSize:"13px",marginBottom:0,borderRadius:"10px"}})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"20px"},children:O?e.jsx("div",{style:{gridColumn:"1/-1",textAlign:"center",padding:"60px"},children:e.jsx("div",{className:"spinner",style:{margin:"0 auto"}})}):x.length===0?e.jsxs("div",{style:{gridColumn:"1/-1",textAlign:"center",padding:"100px 0",background:"rgba(255,255,255,0.01)",borderRadius:"24px",border:"2px dashed rgba(255,255,255,0.05)"},children:[e.jsx(f,{size:48,style:{opacity:.1,margin:"0 auto 15px",color:"var(--primary)"}}),e.jsx("h3",{style:{color:"white",fontSize:"16px",fontWeight:"700"},children:"No History Available"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"13px"},children:"Start recording border taxes for this vehicle."})]}):x.map(t=>e.jsxs(h.div,{layout:!0,whileHover:{scale:1.02},className:"glass-card",style:{padding:"20px",background:"rgba(30, 41, 59, 0.3)",border:"1px solid rgba(255,255,255,0.05)",display:"flex",flexDirection:"column",gap:"15px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{color:"white",fontWeight:"800",fontSize:"15px",margin:0},children:t.borderName}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginTop:"4px"},children:[e.jsx(q,{size:12,color:"var(--primary)"}),e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"700"},children:new Date(t.date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})]})]}),t.receiptPhoto&&e.jsx("a",{href:t.receiptPhoto,target:"_blank",rel:"noreferrer",children:e.jsx("img",{src:t.receiptPhoto,style:{width:"45px",height:"45px",borderRadius:"8px",objectFit:"cover",border:"1px solid rgba(255,255,255,0.1)"}})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderTop:"1px solid rgba(255,255,255,0.05)",paddingTop:"12px"},children:[e.jsxs("div",{style:{color:"var(--primary)",fontWeight:"900",fontSize:"18px"},children:[e.jsx("span",{style:{fontSize:"12px",marginRight:"2px"},children:"₹"}),t.amount?.toLocaleString("en-IN")]}),e.jsx("button",{onClick:()=>M(t._id),style:{background:"none",color:"#f43f5e",fontSize:"11px",fontWeight:"800",cursor:"pointer",opacity:.6},onMouseEnter:r=>r.target.style.opacity=1,onMouseLeave:r=>r.target.style.opacity=.6,children:"DELETE"})]}),t.remarks&&e.jsxs("p",{style:{color:"var(--text-muted)",fontSize:"12px",margin:0,fontStyle:"italic",borderLeft:"2px solid rgba(255,255,255,0.1)",paddingLeft:"8px"},children:['"',t.remarks,'"']})]},t._id))})]})]})]}):e.jsxs("div",{className:"container-fluid",style:{paddingBottom:"40px"},children:[e.jsx(W,{title:"Select Vehicle - Border Tax",description:"Choose a vehicle to manage border tax records."}),e.jsxs("header",{style:{padding:"40px 0",textAlign:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",justifyContent:"center"},children:[e.jsx("div",{style:{width:"clamp(40px,10vw,50px)",height:"clamp(40px,10vw,50px)",background:"linear-gradient(135deg, white, #f8fafc)",borderRadius:"16px",padding:"8px",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},children:e.jsx(f,{size:28,color:"#fbbf24"})}),e.jsxs("div",{style:{textAlign:"left"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[e.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:"#fbbf24",boxShadow:"0 0 8px #fbbf24"}}),e.jsx("span",{style:{fontSize:"clamp(9px,2.5vw,10px)",fontWeight:"800",color:"rgba(255,255,255,0.5)",letterSpacing:"1px",textTransform:"uppercase"},children:"State Permits"})]}),e.jsxs("h1",{style:{color:"white",fontSize:"clamp(24px, 5vw, 32px)",fontWeight:"900",margin:0,letterSpacing:"-1px",cursor:"pointer"},children:["Border Tax ",e.jsx("span",{className:"text-gradient-yellow",children:"Hub"})]})]})]}),e.jsx("p",{style:{color:"var(--text-muted)",marginTop:"10px",fontSize:"16px"},children:"Select a vehicle to manage its crossing records"}),e.jsxs("div",{style:{position:"relative",maxWidth:"500px",margin:"40px auto 0"},children:[e.jsx(y,{size:20,style:{position:"absolute",left:"20px",top:"16px",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Find vehicle by number or model...",className:"input-field",value:m,onChange:t=>P(t.target.value),style:{paddingLeft:"55px",height:"54px",borderRadius:"16px",fontSize:"15px",background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.08)"}})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"20px",marginTop:"20px"},children:[T.map((t,r)=>e.jsxs(h.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:r*.03},whileHover:{y:-5,borderColor:"var(--primary)",boxShadow:"0 10px 30px rgba(14, 165, 233, 0.2)"},onClick:()=>H(t),className:"glass-card",style:{padding:"24px",cursor:"pointer",border:"1px solid rgba(255,255,255,0.05)",background:"linear-gradient(145deg, rgba(30, 41, 59, 0.6), rgba(15, 23, 42, 0.8))",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:"-10%",right:"-10%",width:"80px",height:"80px",background:"var(--primary)",filter:"blur(40px)",opacity:.1}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",position:"relative",zIndex:1},children:[e.jsx("div",{style:{width:"50px",height:"50px",background:"rgba(255,255,255,0.03)",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid rgba(255,255,255,0.05)"},children:e.jsx(b,{size:24,color:"var(--primary)"})}),e.jsxs("div",{children:[e.jsx("h3",{style:{color:"white",margin:0,fontSize:"18px",fontWeight:"800",letterSpacing:"-0.5px"},children:t.carNumber}),e.jsx("p",{style:{color:"var(--text-muted)",margin:"2px 0 0",fontSize:"13px"},children:t.model||"Standard Model"})]})]}),e.jsxs("div",{style:{marginTop:"20px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.4)",fontWeight:"700"},children:[z.filter(a=>a.vehicle?._id===t._id).length," RECORDS"]}),e.jsxs("div",{style:{color:"var(--primary)",fontSize:"12px",fontWeight:"800",display:"flex",alignItems:"center",gap:"5px"},children:["MANAGE ",e.jsx(y,{size:12})]})]})]},t._id)),T.length===0&&e.jsx("div",{style:{gridColumn:"1/-1",textAlign:"center",padding:"60px",color:"var(--text-muted)"},children:e.jsx("p",{children:"No vehicles found matching your search."})})]})]})};export{Y as default};
