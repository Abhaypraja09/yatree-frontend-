import{b as a,j as e,J as O,I as E,p as R,G as _,m as f,E as P,a0 as B,a1 as M,M as b,A as F,X as q}from"./vendor-C_ywCXHK.js";import{u as $,b as U,i as x}from"./index-BIJFZ0ug.js";import{S as G}from"./SEO-BK4B2ZiL.js";import{u,w as X}from"./excel-B9D0dd6c.js";const ee=()=>{const{user:Y}=$(),{selectedCompany:r}=U(),[v,S]=a.useState([]),[w,N]=a.useState([]),[H,z]=a.useState(!0),[T,h]=a.useState(!1),[p,y]=a.useState("list"),[m,W]=a.useState(""),[d,I]=a.useState(new Date().toISOString().split("T")[0]),[j,V]=a.useState("all"),[i,l]=a.useState({name:"",mobile:"",username:"",password:"",salary:0});a.useEffect(()=>{r&&(g(),A())},[r,d]);const g=async()=>{try{const{data:t}=await x.get(`/api/admin/staff/${r._id}`);S(t)}catch(t){console.error("Error fetching staff:",t)}},A=async()=>{if(r?._id)try{const{data:t}=await x.get(`/api/admin/staff-attendance/${r._id}`);N(t),z(!1)}catch(t){console.error("Error fetching staff attendance:",t)}},k=()=>{const t=o.map(s=>({Date:s.date,"Staff Name":s.staff?.name||"Unknown",Mobile:s.staff?.mobile||"N/A","Punch In Time":new Date(s.punchIn.time).toLocaleTimeString(),"Punch In Location":s.punchIn.location?.address||"N/A","Punch Out Time":s.punchOut?.time?new Date(s.punchOut.time).toLocaleTimeString():"On Duty","Punch Out Location":s.punchOut?.location?.address||"N/A",Status:s.status||"Present"})),n=u.json_to_sheet(t),c=u.book_new();u.book_append_sheet(c,n,"Staff Attendance"),X(c,`Staff_Attendance_${d}.xlsx`)},C=async t=>{t.preventDefault();try{await x.post("/api/admin/staff",{...i,companyId:r._id}),h(!1),l({name:"",mobile:"",username:"",password:"",salary:0}),g()}catch(n){alert(n.response?.data?.message||"Error adding staff")}},D=async t=>{if(window.confirm("Are you sure you want to delete this staff member?"))try{await x.delete(`/api/admin/staff/${t}`),g()}catch(n){alert(n.response?.data?.message||"Error deleting staff")}},L=v.filter(t=>t.name.toLowerCase().includes(m.toLowerCase())||t.mobile.includes(m)),o=w.filter(t=>{const n=t.date===d,c=j==="all"||t.staff?._id===j;return n&&c});return e.jsxs("div",{className:"container-fluid",style:{paddingBottom:"40px"},children:[e.jsx(G,{title:"Staff Management"}),e.jsx("header",{style:{padding:"25px 0",marginBottom:"30px",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:e.jsxs("div",{className:"flex-resp",style:{justifyContent:"space-between",alignItems:"flex-start",gap:"20px"},children:[e.jsxs("div",{style:{minWidth:"200px",flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"8px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#6366f1",boxShadow:"0 0 10px #6366f1"}}),e.jsx("span",{style:{fontSize:"11px",fontWeight:"900",color:"rgba(255,255,255,0.4)",letterSpacing:"2px",textTransform:"uppercase"},children:"Internal Asset Operations"})]}),e.jsxs("h1",{className:"resp-title",style:{margin:0,fontWeight:"900",letterSpacing:"-1.5px"},children:["Staff ",e.jsx("span",{style:{color:"var(--secondary)"},children:"Management"})]}),e.jsx("p",{className:"resp-subtitle",style:{marginTop:"8px"},children:"Manage office personnel and monitoring records"})]}),e.jsxs("div",{className:"flex-resp",style:{gap:"15px",alignItems:"center"},children:[e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"14px",padding:"4px",display:"flex",border:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("button",{onClick:()=>y("list"),style:{padding:"10px 18px",borderRadius:"11px",border:"none",background:p==="list"?"var(--primary)":"transparent",color:"white",fontWeight:"800",fontSize:"12px",cursor:"pointer",transition:"0.3s"},children:"LIST"}),e.jsx("button",{onClick:()=>y("attendance"),style:{padding:"10px 18px",borderRadius:"11px",border:"none",background:p==="attendance"?"var(--primary)":"transparent",color:"white",fontWeight:"800",fontSize:"12px",cursor:"pointer",transition:"0.3s"},children:"LOGS"})]}),e.jsxs("button",{onClick:()=>h(!0),className:"btn-primary",style:{display:"flex",alignItems:"center",gap:"8px",height:"50px",padding:"0 20px",fontSize:"14px",fontWeight:"800"},children:[e.jsx(O,{size:20})," ",e.jsx("span",{className:"hide-mobile",children:"ADD STAFF"}),e.jsx("span",{className:"show-mobile",children:"ADD"})]})]})]})}),e.jsxs("div",{className:"flex-resp",style:{gap:"20px",marginBottom:"30px"},children:[e.jsxs("div",{style:{flex:1,minWidth:"0",position:"relative"},children:[e.jsx("input",{type:"text",placeholder:"Search staff...",value:m,onChange:t=>W(t.target.value),className:"input-field",style:{width:"100%",paddingLeft:"45px",marginBottom:0,height:"52px",fontSize:"14px"}}),e.jsx(E,{size:18,style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}})]}),p==="attendance"&&e.jsxs("div",{className:"flex-resp",style:{gap:"10px",width:"100%",flex:1,justifyContent:"flex-end"},children:[e.jsxs("div",{style:{position:"relative",flex:1,minWidth:"0"},children:[e.jsx("input",{type:"date",className:"input-field",value:d,onChange:t=>I(t.target.value),style:{width:"100%",marginBottom:0,height:"52px",paddingLeft:"45px",fontSize:"14px"}}),e.jsx(R,{size:18,style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"var(--primary)"}})]}),e.jsxs("button",{onClick:k,className:"btn-primary",style:{background:"rgba(16, 185, 129, 0.1)",color:"#10b981",border:"1px solid rgba(16, 185, 129, 0.1)",display:"flex",alignItems:"center",gap:"8px",height:"52px",padding:"0 20px",fontSize:"12px",fontWeight:"900"},children:[e.jsx(_,{size:20})," ",e.jsx("span",{className:"hide-mobile",children:"EXPORT EXCEL"}),e.jsx("span",{className:"show-mobile",children:"EXCEL"})]})]})]}),p==="list"?e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"20px"},children:L.map(t=>e.jsxs(f.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},whileHover:{y:-5},className:"glass-card",style:{padding:"24px",border:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginBottom:"20px"},children:[e.jsx("div",{style:{width:"54px",height:"54px",borderRadius:"16px",background:"linear-gradient(135deg, var(--primary), var(--secondary))",display:"flex",justifyContent:"center",alignItems:"center",color:"white",fontSize:"22px",fontWeight:"900",boxShadow:"0 8px 16px rgba(14, 165, 233, 0.2)"},children:t.name.charAt(0)}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h3",{style:{margin:0,color:"white",fontSize:"18px",fontWeight:"800"},children:t.name}),e.jsx("p",{style:{margin:"2px 0 0 0",color:"var(--text-muted)",fontSize:"13px",fontWeight:"500"},children:t.mobile})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[e.jsxs("div",{style:{background:"rgba(255,255,255,0.02)",padding:"12px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.03)"},children:[e.jsx("p",{style:{fontSize:"9px",color:"var(--text-muted)",margin:"0 0 4px 0",textTransform:"uppercase",fontWeight:"900",letterSpacing:"0.5px"},children:"Login ID"}),e.jsx("p",{style:{margin:0,color:"white",fontWeight:"800",fontSize:"14px",overflow:"hidden",textOverflow:"ellipsis"},children:t.username||"Not Set"})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.02)",padding:"12px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.03)"},children:[e.jsx("p",{style:{fontSize:"9px",color:"var(--text-muted)",margin:"0 0 4px 0",textTransform:"uppercase",fontWeight:"900",letterSpacing:"0.5px"},children:"Salary"}),e.jsxs("p",{style:{margin:0,color:"#10b981",fontWeight:"900",fontSize:"14px"},children:["₹",t.salary?.toLocaleString()]})]})]}),e.jsx("div",{style:{marginTop:"20px",paddingTop:"15px",borderTop:"1px solid rgba(255,255,255,0.05)",display:"flex",justifyContent:"flex-end"},children:e.jsxs("button",{onClick:()=>D(t._id),style:{background:"rgba(244, 63, 94, 0.1)",color:"#f43f5e",border:"none",padding:"8px",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",fontSize:"11px",fontWeight:"800"},children:[e.jsx(P,{size:14})," DELETE STAFF"]})})]},t._id))}):e.jsxs("div",{style:{marginTop:"30px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"15px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"var(--primary)",boxShadow:"0 0 10px var(--primary)"}}),e.jsxs("h2",{style:{color:"white",fontSize:"15px",fontWeight:"800",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:["Attendance Log (",o.length,")"]})]}),e.jsx("div",{className:"glass-card hide-mobile",style:{padding:0,overflow:"hidden"},children:e.jsx("div",{className:"scroll-x",children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",color:"white",minWidth:"900px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(255,255,255,0.04)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Staff Member"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Punch In"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Punch Out"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Work Location"})]})}),e.jsx("tbody",{children:o.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"4",style:{padding:"60px",textAlign:"center",color:"var(--text-muted)"},children:["No attendance records found for ",d]})}):o.map(t=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.03)"},children:[e.jsxs("td",{style:{padding:"18px 25px"},children:[e.jsx("div",{style:{fontWeight:"800",color:"white",fontSize:"15px"},children:t.staff?.name}),e.jsx("div",{style:{fontSize:"12px",color:"var(--text-muted)",marginTop:"2px"},children:t.staff?.mobile})]}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"#10b981",fontWeight:"900",fontSize:"14px"},children:[e.jsx(B,{size:16}),new Date(t.punchIn.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})}),e.jsx("td",{style:{padding:"18px 25px"},children:t.punchOut?.time?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"#f43f5e",fontWeight:"900",fontSize:"14px"},children:[e.jsx(M,{size:16}),new Date(t.punchOut.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}):e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",background:"rgba(255,255,255,0.05)",padding:"4px 10px",borderRadius:"30px"},children:"ON DUTY"})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px",color:"var(--text-muted)"},children:[e.jsx(b,{size:14,style:{color:"var(--primary)"}}),e.jsx("span",{style:{maxWidth:"250px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:"500"},children:t.punchIn.location?.address||"Location Hidden"})]}),t.punchIn.location?.latitude&&e.jsx("a",{href:`https://www.google.com/maps?q=${t.punchIn.location.latitude},${t.punchIn.location.longitude}`,target:"_blank",rel:"noopener noreferrer",style:{fontSize:"10px",color:"var(--primary)",fontWeight:"900",letterSpacing:"0.5px"},children:"OPEN IN GOOGLE MAPS"})]})})]},t._id))})]})})}),e.jsx("div",{className:"show-mobile",children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[o.map(t=>e.jsxs(f.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"glass-card",style:{padding:"20px",background:"rgba(30, 41, 59, 0.4)",border:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"800",color:"white",fontSize:"16px"},children:t.staff?.name}),e.jsx("div",{style:{fontSize:"12px",color:"var(--text-muted)"},children:t.staff?.mobile})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{color:"#10b981",fontWeight:"900",fontSize:"18px"},children:"P"}),e.jsx("div",{style:{fontSize:"9px",color:"var(--text-muted)",fontWeight:"800"},children:"PRESENT"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",background:"rgba(0,0,0,0.2)",padding:"15px",borderRadius:"12px",marginBottom:"15px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"9px",color:"var(--text-muted)",fontWeight:"800",textTransform:"uppercase",marginBottom:"4px"},children:"In Time"}),e.jsx("div",{style:{color:"#10b981",fontWeight:"900"},children:new Date(t.punchIn.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"9px",color:"var(--text-muted)",fontWeight:"800",textTransform:"uppercase",marginBottom:"4px"},children:"Out Time"}),e.jsx("div",{style:{color:t.punchOut?.time?"#f43f5e":"var(--text-muted)",fontWeight:"900"},children:t.punchOut?.time?new Date(t.punchOut.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"ON DUTY"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px"},children:[e.jsx(b,{size:14,style:{marginTop:"2px",color:"var(--primary)"}}),e.jsxs("div",{style:{fontSize:"12px",color:"var(--text-muted)",lineHeight:"1.4"},children:[t.punchIn.location?.address,t.punchIn.location?.latitude&&e.jsx("a",{href:`https://www.google.com/maps?q=${t.punchIn.location.latitude},${t.punchIn.location.longitude}`,target:"_blank",rel:"noopener noreferrer",style:{display:"block",marginTop:"6px",color:"var(--primary)",fontWeight:"900",fontSize:"10px"},children:"VIEW ON MAP"})]})]})]},t._id)),o.length===0&&e.jsx("div",{style:{textAlign:"center",padding:"40px",color:"var(--text-muted)",background:"rgba(255,255,255,0.02)",borderRadius:"20px"},children:"No records found for today."})]})})]}),e.jsx(F,{children:T&&e.jsx("div",{className:"modal-overlay",children:e.jsxs(f.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"glass-card modal-content",style:{maxWidth:"550px",width:"100%",background:"#0f172a",padding:"30px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"25px"},children:[e.jsx("h2",{style:{color:"white",fontSize:"20px",fontWeight:"900",margin:0,letterSpacing:"-0.5px"},children:"Add New Staff"}),e.jsx("button",{onClick:()=>h(!1),style:{background:"rgba(255,255,255,0.05)",color:"white",border:"none",padding:"10px",borderRadius:"50%",display:"flex",cursor:"pointer"},children:e.jsx(q,{size:20})})]}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Full Name *"}),e.jsx("input",{type:"text",required:!0,className:"input-field",placeholder:"Enter staff name",value:i.name,onChange:t=>l({...i,name:t.target.value})})]}),e.jsxs("div",{className:"form-grid-2",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Mobile Number *"}),e.jsx("input",{type:"text",required:!0,className:"input-field",placeholder:"10-digit number",value:i.mobile,onChange:t=>l({...i,mobile:t.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Identity / Username *"}),e.jsx("input",{type:"text",required:!0,className:"input-field",placeholder:"Unique username",value:i.username,onChange:t=>l({...i,username:t.target.value})})]})]}),e.jsxs("div",{className:"form-grid-2",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Security Password *"}),e.jsx("input",{type:"password",required:!0,className:"input-field",placeholder:"Min. 6 chars",value:i.password,onChange:t=>l({...i,password:t.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Monthly Salary (₹)"}),e.jsx("input",{type:"number",required:!0,className:"input-field",placeholder:"Amount in INR",value:i.salary,onChange:t=>l({...i,salary:t.target.value})})]})]}),e.jsx("button",{type:"submit",className:"btn-primary",style:{width:"100%",height:"52px",marginTop:"10px",fontSize:"15px",fontWeight:"900"},children:"ONBOARD NEW STAFF"})]})]})})})]})};export{ee as default};
